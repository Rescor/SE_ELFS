##############################################################################
#                                                                            #
# IAR ARM ANSI C/C++ Compiler V4.42A/W32 EVALUATION    10/Jun/2013  22:59:41 #
# Copyright 1999-2005 IAR Systems. All rights reserved.                      #
#                                                                            #
#    Cpu mode        =  interwork                                            #
#    Endian          =  little                                               #
#    Stack alignment =  4                                                    #
#    Source file     =  Z:\home\perk11\www\perk11.info\svn\SE\ExtEditor\main #
#                       .cpp                                                 #
#    Command line    =  Z:\home\perk11\www\perk11.info\svn\SE\ExtEditor\main #
#                       .cpp -D NDEBUG -D OLDFUNCTIONS -lCN                  #
#                       Z:\home\perk11\www\perk11.info\svn\SE\ExtEditor\Rele #
#                       ase\List\ -la Z:\home\perk11\www\perk11.info\svn\SE\ #
#                       ExtEditor\Release\List\ -o                           #
#                       Z:\home\perk11\www\perk11.info\svn\SE\ExtEditor\Rele #
#                       ase\Obj\ -s9 --no_unroll --no_code_motion            #
#                       --cpu_mode arm --endian little --cpu ARM926EJ-S      #
#                       --stack_align 4 --interwork -e --enable_multibytes   #
#                       --fpu None --eec++ --dlib_config                     #
#                       Z:\home\perk11\IAR2\arm\LIB\dl5tpainl8n.h -I         #
#                       Z:\home\perk11\IAR2\arm\INC\ --inline_threshold=2    #
#    List file       =  Z:\home\perk11\www\perk11.info\svn\SE\ExtEditor\Rele #
#                       ase\List\main.lst                                    #
#    Object file     =  Z:\home\perk11\www\perk11.info\svn\SE\ExtEditor\Rele #
#                       ase\Obj\main.r79                                     #
#                                                                            #
#                                                                            #
##############################################################################

Z:\home\perk11\www\perk11.info\svn\SE\ExtEditor\main.cpp
      1          #include "..\\include\Lib_Clara.h"
      2          #include "..\\include\Dir.h"
      3          #include "..\\include\var_arg.h"
      4          #include "main.h"
      5          //#include "log.h"
      6          #include "revision.h"
      7          
      8          #pragma segment="ELFBEGIN"

   \                                 In segment CODE, align 4, keep-with-next
      9          void elf_exit(void){
   \                     ??elf_exit:
   \   00000000   00402DE9           PUSH     {LR}
     10            kill_data(__segment_begin("ELFBEGIN"), (void(*)(void*))mfree_adr());
   \   00000004   048100EF           SWI      +33028
   \   00000008   0010A0E1           MOV      R1,R0
   \   0000000C   04009FE5           LDR      R0,??elf_exit_1  ;; SFB(ELFBEGIN)
   \   00000010   0040BDE8           POP      {LR}             ;; Pop
   \   00000014   ........           _BF      kill_data,??kill_data??rA  ;; tailcall
   \                     ??elf_exit_1:
   \   00000018   ........           DC32     SFB(ELFBEGIN)
     11          }
     12          
     13          int isExtEditorBook(BOOK * struc);
     14          

   \                                 In segment CODE, align 4, keep-with-next
     15          void win12512unicode(wchar_t *ws, const char *s, int len)
     16          {
   \                     ??win12512unicode:
   \   00000000   040000EA           B        ??win12512unicode_1
     17            int c;
     18            while((c=*s++)&&((len--)>0))
     19            {
     20              if (c==0xA8) c=0x401;
     21              if (c==0xAA) c=0x404;
     22              if (c==0xAF) c=0x407;
     23              if (c==0xB8) c=0x451;
     24              if (c==0xBA) c=0x454;
     25              if (c==0xBF) c=0x457;
     26              if ((c>=0xC0)&&(c<0x100)) c+=0x350;
   \                     ??win12512unicode_2:
   \   00000004   C00053E3           CMP      R3,#+192
   \   00000008   010000BA           BLT      ??win12512unicode_3
   \   0000000C   400F53E3           CMP      R3,#+256
   \   00000010   D43F83B2           ADDLT    R3,R3,#+848
     27              *ws++=c;
   \                     ??win12512unicode_3:
   \   00000014   ........           STRH     R3,[R0], #+2
   \                     ??win12512unicode_1:
   \   00000018   ........           LDRB     R3,[R1], #+1
   \   0000001C   000053E3           CMP      R3,#+0
   \   00000020   1900000A           BEQ      ??win12512unicode_4
   \   00000024   02C0A0E1           MOV      R12,R2
   \   00000028   01204CE2           SUB      R2,R12,#+1
   \   0000002C   01005CE3           CMP      R12,#+1
   \   00000030   150000BA           BLT      ??win12512unicode_4
   \   00000034   A80053E3           CMP      R3,#+168
   \   00000038   0200001A           BNE      ??win12512unicode_5
   \   0000003C   0130A0E3           MOV      R3,#+1
   \                     ??win12512unicode_6:
   \   00000040   403E83E3           ORR      R3,R3,#0x400
   \   00000044   F2FFFFEA           B        ??win12512unicode_3
   \                     ??win12512unicode_5:
   \   00000048   AA0053E3           CMP      R3,#+170
   \   0000004C   0430A003           MOVEQ    R3,#+4
   \   00000050   FAFFFF0A           BEQ      ??win12512unicode_6
   \   00000054   AF0053E3           CMP      R3,#+175
   \   00000058   0100001A           BNE      ??win12512unicode_7
   \   0000005C   0730A0E3           MOV      R3,#+7
   \                     ??win12512unicode_8:
   \   00000060   F6FFFFEA           B        ??win12512unicode_6
   \                     ??win12512unicode_7:
   \   00000064   B80053E3           CMP      R3,#+184
   \   00000068   5130A003           MOVEQ    R3,#+81
   \   0000006C   F3FFFF0A           BEQ      ??win12512unicode_6
   \   00000070   BA0053E3           CMP      R3,#+186
   \   00000074   5430A003           MOVEQ    R3,#+84
   \   00000078   F0FFFF0A           BEQ      ??win12512unicode_6
   \   0000007C   BF0053E3           CMP      R3,#+191
   \   00000080   DFFFFF1A           BNE      ??win12512unicode_2
   \   00000084   5730A0E3           MOV      R3,#+87
   \   00000088   ECFFFFEA           B        ??win12512unicode_6
     28            }
     29            *ws=0;
   \                     ??win12512unicode_4:
   \   0000008C   0010A0E3           MOV      R1,#+0
   \   00000090   B010C0E1           STRH     R1,[R0, #+0]
     30          }
   \   00000094   1EFF2FE1           BX       LR               ;; return
     31          

   \                                 In segment CODE, align 4, keep-with-next
     32          char *unicode2win1251(char *s, wchar_t *ws, int len)
     33          {
   \                     ??unicode2win1251:
   \   00000000   10002DE9           PUSH     {R4}
     34            char *d=s;
   \   00000004   0030A0E1           MOV      R3,R0
   \   00000008   060000EA           B        ??unicode2win1251_1
     35            int c;
     36            while((c=*ws++)&&((len--)>0))
     37            {
     38              if (c==0x401) c=0xA8;
     39              if (c==0x404) c=0xAA;
     40              if (c==0x407) c=0xAF;
     41              if (c==0x451) c=0xB8;
     42              if (c==0x454) c=0xBA;
     43              if (c==0x457) c=0xBF;
     44              if ((c>=0x410)&&(c<0x450)) c-=0x350;
   \                     ??unicode2win1251_2:
   \   0000000C   410E5CE3           CMP      R12,#+1040
   \   00000010   030000BA           BLT      ??unicode2win1251_3
   \   00000014   450E5CE3           CMP      R12,#+1104
   \   00000018   4F40E0B3           MVNLT    R4,#+79
   \   0000001C   C04FC4B3           BICLT    R4,R4,#0x300
   \   00000020   0CC084B0           ADDLT    R12,R4,R12
     45              *s++=c;
   \                     ??unicode2win1251_3:
   \   00000024   ........           STRB     R12,[R0], #+1
   \                     ??unicode2win1251_1:
   \   00000028   ........           LDRH     R12,[R1], #+2
   \   0000002C   00005CE3           CMP      R12,#+0
   \   00000030   1D00000A           BEQ      ??unicode2win1251_4
   \   00000034   0240A0E1           MOV      R4,R2
   \   00000038   012044E2           SUB      R2,R4,#+1
   \   0000003C   010054E3           CMP      R4,#+1
   \   00000040   190000BA           BLT      ??unicode2win1251_4
   \   00000044   0140A0E3           MOV      R4,#+1
   \   00000048   404E84E3           ORR      R4,R4,#0x400
   \   0000004C   04005CE1           CMP      R12,R4
   \   00000050   A8C0A003           MOVEQ    R12,#+168
   \   00000054   F2FFFF0A           BEQ      ??unicode2win1251_3
   \   00000058   034084E2           ADD      R4,R4,#+3
   \   0000005C   04005CE1           CMP      R12,R4
   \   00000060   AAC0A003           MOVEQ    R12,#+170
   \   00000064   EEFFFF0A           BEQ      ??unicode2win1251_3
   \   00000068   034084E3           ORR      R4,R4,#0x3
   \   0000006C   04005CE1           CMP      R12,R4
   \   00000070   AFC0A003           MOVEQ    R12,#+175
   \   00000074   EAFFFF0A           BEQ      ??unicode2win1251_3
   \   00000078   4A4084E2           ADD      R4,R4,#+74
   \   0000007C   04005CE1           CMP      R12,R4
   \   00000080   B8C0A003           MOVEQ    R12,#+184
   \   00000084   E6FFFF0A           BEQ      ??unicode2win1251_3
   \   00000088   034084E2           ADD      R4,R4,#+3
   \   0000008C   04005CE1           CMP      R12,R4
   \   00000090   BAC0A003           MOVEQ    R12,#+186
   \   00000094   E2FFFF0A           BEQ      ??unicode2win1251_3
   \   00000098   034084E3           ORR      R4,R4,#0x3
   \   0000009C   04005CE1           CMP      R12,R4
   \   000000A0   D9FFFF1A           BNE      ??unicode2win1251_2
   \   000000A4   BFC0A0E3           MOV      R12,#+191
   \   000000A8   DDFFFFEA           B        ??unicode2win1251_3
     46            }
     47            *s=0;
   \                     ??unicode2win1251_4:
   \   000000AC   0010A0E3           MOV      R1,#+0
   \   000000B0   0010C0E5           STRB     R1,[R0, #+0]
     48            return(d);
   \   000000B4   1000BDE8           POP      {R4}
   \   000000B8   0300A0E1           MOV      R0,R3
   \   000000BC   1EFF2FE1           BX       LR               ;; return
     49          }
     50          

   \                                 In segment CODE, align 4, keep-with-next
     51          int strcmp_nocase(const char *s, const char *d)
     52          {
     53            int cs;
     54            int ds;
     55            do
     56            {
     57              cs=*s++;
   \                     ??strcmp_nocase:
   \                     ??strcmp_nocase_1:
   \   00000000   ........           LDRB     R2,[R0], #+1
     58              if (cs&0x40) cs&=0xDF;
     59              ds=*d++;
   \   00000004   ........           LDRB     R3,[R1], #+1
   \   00000008   400012E3           TST      R2,#0x40
   \   0000000C   DF200212           ANDNE    R2,R2,#0xDF
     60              if (ds&0x40) ds&=0xDF;
   \   00000010   400013E3           TST      R3,#0x40
   \   00000014   DF300312           ANDNE    R3,R3,#0xDF
     61              cs-=ds;
   \   00000018   032052E0           SUBS     R2,R2,R3
     62              if (cs) break;
   \   0000001C   0100001A           BNE      ??strcmp_nocase_2
     63            }
     64            while(ds);
   \   00000020   000053E3           CMP      R3,#+0
   \   00000024   F5FFFF1A           BNE      ??strcmp_nocase_1
     65            return(cs);
   \                     ??strcmp_nocase_2:
   \   00000028   0200A0E1           MOV      R0,R2
   \   0000002C   1EFF2FE1           BX       LR               ;; return
     66          }
     67          

   \                                 In segment CODE, align 4, keep-with-next
     68          static int TerminateElf(void * ,BOOK* book)
     69          {
   \                     ??TerminateElf:
   \   00000000   00402DE9           PUSH     {LR}
   \   00000004   0100A0E1           MOV      R0,R1
     70            FreeBook(book);
   \   00000008   2F0100EF           SWI      +303
     71            return(1);
   \   0000000C   0100A0E3           MOV      R0,#+1
   \   00000010   0080BDE8           POP      {PC}             ;; return
     72          }
     73          

   \                                 In segment CODE, align 4, keep-with-next
     74          static int ShowAuthorInfo(void *mess ,BOOK *book)
     75          {
     76            MSG * msg = (MSG *)mess;
     77            wchar_t ustr[64];
     78            snwprintf(ustr,MAXELEMS(ustr)-1,L"\nExtEditor v1.0\nRevision %d\n(c) KreN",__SVN_REVISION__);
   \                     ??ShowAuthorInfo:
   \   00000000   64209FE5           LDR      R2,??ShowAuthorInfo_1  ;; `?<Constant L"\\xa\\x45\\x78\\x74\\x45\\x64\\x69\\x74\\x`
   \   00000004   10402DE9           PUSH     {R4,LR}
   \   00000008   80D04DE2           SUB      SP,SP,#+128
   \   0000000C   5530A0E3           MOV      R3,#+85
   \   00000010   0040A0E1           MOV      R4,R0
   \   00000014   E03E83E3           ORR      R3,R3,#0xE00
   \   00000018   3F10A0E3           MOV      R1,#+63
   \   0000001C   0D00A0E1           MOV      R0,SP
   \   00000020   150100EF           SWI      +277
     79            MessageBox(LGP_NULL,TextID_Create(ustr,ENC_UCS2,MAXELEMS(ustr)-1), NOIMAGE, 1, 5000,msg->book);
   \   00000024   3F20A0E3           MOV      R2,#+63
   \   00000028   0010A0E3           MOV      R1,#+0
   \   0000002C   0D00A0E1           MOV      R0,SP
   \   00000030   5D0100EF           SWI      +349
   \   00000034   001094E5           LDR      R1,[R4, #+0]
   \   00000038   0130A0E3           MOV      R3,#+1
   \   0000003C   02002DE9           PUSH     {R1}
   \   00000040   FF20A0E3           MOV      R2,#+255
   \   00000044   FF2C82E3           ORR      R2,R2,#0xFF00
   \   00000048   8810A0E3           MOV      R1,#+136
   \   0000004C   4C1D81E3           ORR      R1,R1,#0x1300
   \   00000050   02002DE9           PUSH     {R1}
   \   00000054   0010A0E1           MOV      R1,R0
   \   00000058   9004E0E3           MVN      R0,#-1879048192
   \   0000005C   570200EF           SWI      +599
     80            return(1);
   \   00000060   0100A0E3           MOV      R0,#+1
   \   00000064   88D08DE2           ADD      SP,SP,#+136
   \   00000068   1080BDE8           POP      {R4,PC}          ;; return
   \                     ??ShowAuthorInfo_1:
   \   0000006C   ........           DC32     `?<Constant L"\\xa\\x45\\x78\\x74\\x45\\x64\\x69\\x74\\x`
     81          }
     82          

   \                                 In segment DYN_PAGE, align 4, align-sorted
     83          const PAGE_MSG bk_msglst_base[] @ "DYN_PAGE"  = 
   \                     bk_msglst_base:
   \   00000000   E5030000....       DC32 997, ??TerminateElf, 998, ??ShowAuthorInfo, 64, 0H
   \              ....E6030000
   \              ........4000
   \              000000000000
     84          {
     85            ELF_TERMINATE_EVENT,     TerminateElf,
     86            ELF_SHOW_INFO_EVENT,     ShowAuthorInfo,
     87            NIL_EVENT_TAG,           NULL
     88          };
     89          
     90          const PAGE_DESC bk_base = {"ExtEditor_Base_Page",0,bk_msglst_base};
     91          

   \                                 In segment CODE, align 4, keep-with-next
     92          void SafeFreeString(MyBOOK *mbk, char *str)
     93          {
   \                     ??SafeFreeString:
   \   00000000   00402DE9           PUSH     {LR}
     94            if (str<mbk->ebuf || str>=(mbk->ebuf+mbk->ebuf_len+1))
   \   00000004   1C2090E5           LDR      R2,[R0, #+28]
   \   00000008   020051E1           CMP      R1,R2
   \   0000000C   0500003A           BCC      ??SafeFreeString_1
   \   00000010   202090E5           LDR      R2,[R0, #+32]
   \   00000014   1C0090E5           LDR      R0,[R0, #+28]
   \   00000018   000082E0           ADD      R0,R2,R0
   \   0000001C   010080E2           ADD      R0,R0,#+1
   \   00000020   000051E1           CMP      R1,R0
   \   00000024   0080BD38           POPCC    {PC}
     95              delete str;
   \                     ??SafeFreeString_1:
   \   00000028   0100A0E1           MOV      R0,R1
   \   0000002C   ........           _BLF     `??operator delete`,`??operator delete??rA`
     96          }
   \   00000030   0080BDE8           POP      {PC}             ;; return
     97          

   \                                 In segment CODE, align 4, keep-with-next
     98          void DestroyStringList(MyBOOK *mbk)
     99          {
   \                     ??DestroyStringList:
   \   00000000   10402DE9           PUSH     {R4,LR}
   \   00000004   0040A0E1           MOV      R4,R0
   \   00000008   240094E5           LDR      R0,[R4, #+36]
   \   0000000C   B200D0E1           LDRH     R0,[R0, #+2]
   \   00000010   000050E3           CMP      R0,#+0
   \   00000014   1080BD08           POPEQ    {R4,PC}
    100            while(mbk->astr->FirstFree)
    101            {
    102              char *str=(char *)List_RemoveAt(mbk->astr,0);
   \                     ??DestroyStringList_1:
   \   00000018   240094E5           LDR      R0,[R4, #+36]
   \   0000001C   0010A0E3           MOV      R1,#+0
   \   00000020   790100EF           SWI      +377
    103              SafeFreeString(mbk, str);
   \   00000024   0010A0E1           MOV      R1,R0
   \   00000028   0400A0E1           MOV      R0,R4
   \   0000002C   ........           BL       ??SafeFreeString
    104            }
   \   00000030   240094E5           LDR      R0,[R4, #+36]
   \   00000034   B200D0E1           LDRH     R0,[R0, #+2]
   \   00000038   000050E3           CMP      R0,#+0
   \   0000003C   F5FFFF1A           BNE      ??DestroyStringList_1
    105          }
   \   00000040   1080BDE8           POP      {R4,PC}          ;; return
    106          

   \                                 In segment CODE, align 4, keep-with-next
    107          char *find_eol(char *s, int *skip)
    108          {
    109            char *s1=NULL;
   \                     ??find_eol:
   \   00000000   0020A0E3           MOV      R2,#+0
   \   00000004   000000EA           B        ??find_eol_1
    110            int c;
    111            while((c=*s))
    112            {
    113              if ((c=='\r' && *(s+1)=='\n') || (c=='\n' && *(s+1)=='\r')) {
    114                s1=s; *skip=2; break;
    115              }
    116              if (c=='\r' || c=='\n') {
    117                s1=s; *skip=1; break;
    118              }
    119              s++;
   \                     ??find_eol_2:
   \   00000008   010080E2           ADD      R0,R0,#+1
   \                     ??find_eol_1:
   \   0000000C   0030D0E5           LDRB     R3,[R0, #+0]
   \   00000010   000053E3           CMP      R3,#+0
   \   00000014   0700000A           BEQ      ??find_eol_3
   \   00000018   0D0053E3           CMP      R3,#+13
   \   0000001C   0700001A           BNE      ??find_eol_4
   \   00000020   0120D0E5           LDRB     R2,[R0, #+1]
   \   00000024   0A0052E3           CMP      R2,#+10
   \   00000028   0900000A           BEQ      ??find_eol_5
   \                     ??find_eol_6:
   \   0000002C   0020A0E1           MOV      R2,R0
   \   00000030   0100A0E3           MOV      R0,#+1
   \                     ??find_eol_7:
   \   00000034   000081E5           STR      R0,[R1, #+0]
    120            }
    121            return s1; 
   \                     ??find_eol_3:
   \   00000038   0200A0E1           MOV      R0,R2
   \   0000003C   1EFF2FE1           BX       LR               ;; return
   \                     ??find_eol_4:
   \   00000040   0A0053E3           CMP      R3,#+10
   \   00000044   EFFFFF1A           BNE      ??find_eol_2
   \   00000048   0120D0E5           LDRB     R2,[R0, #+1]
   \   0000004C   0D0052E3           CMP      R2,#+13
   \   00000050   F5FFFF1A           BNE      ??find_eol_6
   \                     ??find_eol_5:
   \   00000054   0020A0E1           MOV      R2,R0
   \   00000058   0200A0E3           MOV      R0,#+2
   \   0000005C   F4FFFFEA           B        ??find_eol_7
    122          }
    123          

   \                                 In segment CODE, align 4, keep-with-next
    124          char *strchr(char *s, int ch)
    125          {
    126            char *ret=NULL;
    127            int c;
    128            if (s)
   \                     ??strchr:
   \   00000000   000050E3           CMP      R0,#+0
   \   00000004   0200001A           BNE      ??strchr_1
    129            {
    130              while((c=*s))
    131              {
    132                if (c==ch) return s;
    133                s++;
    134              }
    135            }
    136            return (ret);
   \                     ??strchr_2:
   \   00000008   0000A0E3           MOV      R0,#+0
   \   0000000C   1EFF2FE1           BX       LR               ;; return
   \                     ??strchr_3:
   \   00000010   010080E2           ADD      R0,R0,#+1
   \                     ??strchr_1:
   \   00000014   0020D0E5           LDRB     R2,[R0, #+0]
   \   00000018   000052E3           CMP      R2,#+0
   \   0000001C   F9FFFF0A           BEQ      ??strchr_2
   \   00000020   010052E1           CMP      R2,R1
   \   00000024   F9FFFF1A           BNE      ??strchr_3
   \   00000028   1EFF2FE1           BX       LR
    137          }
    138          
    139          #pragma inline
    140          int IsDigit(int c)
    141          {
    142            return (c>='0' && c<='9');  
    143          }
    144          
    145          
    146          
    147          
    148          

   \                                 In segment CODE, align 4, keep-with-next
    149          int GetExtInfo(char *str, char *ext, char *elf, char *ismall, char *ibig)
    150          {
   \                     ??GetExtInfo:
   \   00000000   F0472DE9           PUSH     {R4-R10,LR}
   \   00000004   20809DE5           LDR      R8,[SP, #+32]
    151            int ret=-1;
    152            char *s=str;
   \   00000008   0040A0E1           MOV      R4,R0
   \   0000000C   0000D4E5           LDRB     R0,[R4, #+0]
   \   00000010   0150A0E1           MOV      R5,R1
   \   00000014   0260A0E1           MOV      R6,R2
   \   00000018   0370A0E1           MOV      R7,R3
   \   0000001C   0090E0E3           MVN      R9,#+0
   \   00000020   200050E3           CMP      R0,#+32
   \   00000024   0200001A           BNE      ??GetExtInfo_1
    153            while(*s==' ') s++; 
   \                     ??GetExtInfo_2:
   \   00000028   0100F4E5           LDRB     R0,[R4, #+1]!
   \   0000002C   200050E3           CMP      R0,#+32
   \   00000030   FCFFFF0A           BEQ      ??GetExtInfo_2
    154            if (s[0]=='[' && s[1]=='E' && s[2]=='X' && s[3]=='T' &&
    155                IsDigit(s[4]) && IsDigit(s[5]) && s[6]==']')
   \                     ??GetExtInfo_1:
   \   00000034   0000D4E5           LDRB     R0,[R4, #+0]
   \   00000038   5B0050E3           CMP      R0,#+91
   \   0000003C   0100D405           LDRBEQ   R0,[R4, #+1]
   \   00000040   45005003           CMPEQ    R0,#+69
   \   00000044   0200D405           LDRBEQ   R0,[R4, #+2]
   \   00000048   58005003           CMPEQ    R0,#+88
   \   0000004C   0300D405           LDRBEQ   R0,[R4, #+3]
   \   00000050   54005003           CMPEQ    R0,#+84
   \   00000054   8300001A           BNE      ??GetExtInfo_3
   \   00000058   0400D4E5           LDRB     R0,[R4, #+4]
   \   0000005C   300050E3           CMP      R0,#+48
   \   00000060   800000BA           BLT      ??GetExtInfo_3
   \   00000064   3A0050E3           CMP      R0,#+58
   \   00000068   7E0000AA           BGE      ??GetExtInfo_3
   \   0000006C   0500D4E5           LDRB     R0,[R4, #+5]
   \   00000070   300050E3           CMP      R0,#+48
   \   00000074   7B0000BA           BLT      ??GetExtInfo_3
   \   00000078   3A0050E3           CMP      R0,#+58
   \   0000007C   790000AA           BGE      ??GetExtInfo_3
   \   00000080   0600D4E5           LDRB     R0,[R4, #+6]
   \   00000084   5D0050E3           CMP      R0,#+93
   \   00000088   7600001A           BNE      ??GetExtInfo_3
    156            {
    157              int id=((s[4])-'0')*10+((s[5])-'0');
   \   0000008C   0400D4E5           LDRB     R0,[R4, #+4]
   \   00000090   0520D4E5           LDRB     R2,[R4, #+5]
   \   00000094   0A10A0E3           MOV      R1,#+10
   \   00000098   912020E0           MLA      R0,R1,R0,R2
   \   0000009C   0F10E0E3           MVN      R1,#+15
   \   000000A0   801FC1E3           BIC      R1,R1,#0x200
   \   000000A4   00A081E0           ADD      R10,R1,R0
    158              s+=7;
    159              s=strchr(s, ':');
   \   000000A8   3A10A0E3           MOV      R1,#+58
   \   000000AC   070084E2           ADD      R0,R4,#+7
   \   000000B0   ........           BL       ??strchr
   \   000000B4   0040B0E1           MOVS     R4,R0
    160              if (s)
   \   000000B8   6A00000A           BEQ      ??GetExtInfo_3
    161              {
    162                s++;
    163                while(*s==' ') s++;
   \                     ??GetExtInfo_4:
   \   000000BC   0100F4E5           LDRB     R0,[R4, #+1]!
   \   000000C0   200050E3           CMP      R0,#+32
   \   000000C4   FCFFFF0A           BEQ      ??GetExtInfo_4
    164                char *next=strchr(s, ',');
   \   000000C8   2C10A0E3           MOV      R1,#+44
   \   000000CC   0400A0E1           MOV      R0,R4
   \   000000D0   ........           BL       ??strchr
    165                if (next)   // ext
   \   000000D4   000050E3           CMP      R0,#+0
   \   000000D8   6200000A           BEQ      ??GetExtInfo_3
    166                {
    167                  char *ss=next-1;
   \   000000DC   011040E2           SUB      R1,R0,#+1
   \   000000E0   0020D1E5           LDRB     R2,[R1, #+0]
   \   000000E4   200052E3           CMP      R2,#+32
   \   000000E8   0200001A           BNE      ??GetExtInfo_5
    168                  while(*ss==' ') ss--;
   \                     ??GetExtInfo_6:
   \   000000EC   012071E5           LDRB     R2,[R1, #-1]!
   \   000000F0   200052E3           CMP      R2,#+32
   \   000000F4   FCFFFF0A           BEQ      ??GetExtInfo_6
    169                  if (ext)
   \                     ??GetExtInfo_5:
   \   000000F8   000055E3           CMP      R5,#+0
   \   000000FC   0600000A           BEQ      ??GetExtInfo_7
   \   00000100   010000EA           B        ??GetExtInfo_8
    170                  {
    171                    while(s<=ss) *ext++=*s++;
   \                     ??GetExtInfo_9:
   \   00000104   ........           LDRB     R2,[R4], #+1
   \   00000108   ........           STRB     R2,[R5], #+1
   \                     ??GetExtInfo_8:
   \   0000010C   040051E1           CMP      R1,R4
   \   00000110   FBFFFF2A           BCS      ??GetExtInfo_9
    172                    *ext=0;        
   \   00000114   0010A0E3           MOV      R1,#+0
   \   00000118   0010C5E5           STRB     R1,[R5, #+0]
    173                  }
    174                  s=next+1;
   \                     ??GetExtInfo_7:
   \   0000011C   014080E2           ADD      R4,R0,#+1
   \   00000120   0000D4E5           LDRB     R0,[R4, #+0]
   \   00000124   200050E3           CMP      R0,#+32
   \   00000128   0200001A           BNE      ??GetExtInfo_10
    175                  while(*s==' ') s++;
   \                     ??GetExtInfo_11:
   \   0000012C   0100F4E5           LDRB     R0,[R4, #+1]!
   \   00000130   200050E3           CMP      R0,#+32
   \   00000134   FCFFFF0A           BEQ      ??GetExtInfo_11
    176                  next=strchr(s, ',');
   \                     ??GetExtInfo_10:
   \   00000138   2C10A0E3           MOV      R1,#+44
   \   0000013C   0400A0E1           MOV      R0,R4
   \   00000140   ........           BL       ??strchr
    177                  if (next)     // big
   \   00000144   000050E3           CMP      R0,#+0
   \   00000148   4600000A           BEQ      ??GetExtInfo_3
    178                  {
    179                    ss=next-1;
   \   0000014C   011040E2           SUB      R1,R0,#+1
   \   00000150   0020D1E5           LDRB     R2,[R1, #+0]
   \   00000154   200052E3           CMP      R2,#+32
   \   00000158   0200001A           BNE      ??GetExtInfo_12
    180                    while(*ss==' ') ss--;
   \                     ??GetExtInfo_13:
   \   0000015C   012071E5           LDRB     R2,[R1, #-1]!
   \   00000160   200052E3           CMP      R2,#+32
   \   00000164   FCFFFF0A           BEQ      ??GetExtInfo_13
    181                    if (ibig)
   \                     ??GetExtInfo_12:
   \   00000168   000058E3           CMP      R8,#+0
   \   0000016C   0600000A           BEQ      ??GetExtInfo_14
   \   00000170   010000EA           B        ??GetExtInfo_15
    182                    {
    183                      while(s<=ss) *ibig++=*s++;
   \                     ??GetExtInfo_16:
   \   00000174   ........           LDRB     R2,[R4], #+1
   \   00000178   ........           STRB     R2,[R8], #+1
   \                     ??GetExtInfo_15:
   \   0000017C   040051E1           CMP      R1,R4
   \   00000180   FBFFFF2A           BCS      ??GetExtInfo_16
    184                      *ibig=0;        
   \   00000184   0010A0E3           MOV      R1,#+0
   \   00000188   0010C8E5           STRB     R1,[R8, #+0]
    185                    }
    186                    s=next+1;
   \                     ??GetExtInfo_14:
   \   0000018C   014080E2           ADD      R4,R0,#+1
   \   00000190   0000D4E5           LDRB     R0,[R4, #+0]
   \   00000194   200050E3           CMP      R0,#+32
   \   00000198   0200001A           BNE      ??GetExtInfo_17
    187                    while(*s==' ') s++;
   \                     ??GetExtInfo_18:
   \   0000019C   0100F4E5           LDRB     R0,[R4, #+1]!
   \   000001A0   200050E3           CMP      R0,#+32
   \   000001A4   FCFFFF0A           BEQ      ??GetExtInfo_18
    188                    next=strchr(s, ',');
   \                     ??GetExtInfo_17:
   \   000001A8   2C10A0E3           MOV      R1,#+44
   \   000001AC   0400A0E1           MOV      R0,R4
   \   000001B0   ........           BL       ??strchr
    189                    if (next)   // small
   \   000001B4   000050E3           CMP      R0,#+0
   \   000001B8   2A00000A           BEQ      ??GetExtInfo_3
    190                    {
    191                      ss=next-1;
   \   000001BC   011040E2           SUB      R1,R0,#+1
   \   000001C0   0020D1E5           LDRB     R2,[R1, #+0]
   \   000001C4   200052E3           CMP      R2,#+32
   \   000001C8   0200001A           BNE      ??GetExtInfo_19
    192                      while(*ss==' ') ss--;
   \                     ??GetExtInfo_20:
   \   000001CC   012071E5           LDRB     R2,[R1, #-1]!
   \   000001D0   200052E3           CMP      R2,#+32
   \   000001D4   FCFFFF0A           BEQ      ??GetExtInfo_20
    193                      if (ismall)
   \                     ??GetExtInfo_19:
   \   000001D8   000057E3           CMP      R7,#+0
   \   000001DC   0600000A           BEQ      ??GetExtInfo_21
   \   000001E0   010000EA           B        ??GetExtInfo_22
    194                      {
    195                        while(s<=ss) *ismall++=*s++;
   \                     ??GetExtInfo_23:
   \   000001E4   ........           LDRB     R2,[R4], #+1
   \   000001E8   ........           STRB     R2,[R7], #+1
   \                     ??GetExtInfo_22:
   \   000001EC   040051E1           CMP      R1,R4
   \   000001F0   FBFFFF2A           BCS      ??GetExtInfo_23
    196                        *ismall=0;        
   \   000001F4   0010A0E3           MOV      R1,#+0
   \   000001F8   0010C7E5           STRB     R1,[R7, #+0]
    197                      }
    198                      s=next+1;   // elf
   \                     ??GetExtInfo_21:
   \   000001FC   014080E2           ADD      R4,R0,#+1
   \   00000200   0000D4E5           LDRB     R0,[R4, #+0]
   \   00000204   200050E3           CMP      R0,#+32
   \   00000208   0200001A           BNE      ??GetExtInfo_24
    199                      while(*s==' ') s++;
   \                     ??GetExtInfo_25:
   \   0000020C   0100F4E5           LDRB     R0,[R4, #+1]!
   \   00000210   200050E3           CMP      R0,#+32
   \   00000214   FCFFFF0A           BEQ      ??GetExtInfo_25
    200                      ss=s+strlen(s)-1;
   \                     ??GetExtInfo_24:
   \   00000218   0400A0E1           MOV      R0,R4
   \   0000021C   5A0100EF           SWI      +346
   \   00000220   040080E0           ADD      R0,R0,R4
   \   00000224   011040E2           SUB      R1,R0,#+1
   \   00000228   0000D1E5           LDRB     R0,[R1, #+0]
   \   0000022C   200050E3           CMP      R0,#+32
   \   00000230   0200001A           BNE      ??GetExtInfo_26
    201                      while(*ss==' ') ss--;
   \                     ??GetExtInfo_27:
   \   00000234   010071E5           LDRB     R0,[R1, #-1]!
   \   00000238   200050E3           CMP      R0,#+32
   \   0000023C   FCFFFF0A           BEQ      ??GetExtInfo_27
    202                      if (elf)
   \                     ??GetExtInfo_26:
   \   00000240   000056E3           CMP      R6,#+0
   \   00000244   0600000A           BEQ      ??GetExtInfo_28
   \   00000248   010000EA           B        ??GetExtInfo_29
    203                      {
    204                        while(s<=ss) *elf++=*s++;
   \                     ??GetExtInfo_30:
   \   0000024C   ........           LDRB     R0,[R4], #+1
   \   00000250   ........           STRB     R0,[R6], #+1
   \                     ??GetExtInfo_29:
   \   00000254   040051E1           CMP      R1,R4
   \   00000258   FBFFFF2A           BCS      ??GetExtInfo_30
    205                        *elf=0;        
   \   0000025C   0000A0E3           MOV      R0,#+0
   \   00000260   0000C6E5           STRB     R0,[R6, #+0]
    206                      }
    207                      ret=id;
   \                     ??GetExtInfo_28:
   \   00000264   0A90A0E1           MOV      R9,R10
    208                    }
    209                  }
    210                }
    211              }
    212            }
    213            return (ret);
   \                     ??GetExtInfo_3:
   \   00000268   0900A0E1           MOV      R0,R9
   \   0000026C   F087BDE8           POP      {R4-R10,PC}      ;; return
    214          }
    215          

   \                                 In segment CODE, align 4, keep-with-next
    216          int IsStringValid(char *s)
    217          {
   \                     ??IsStringValid:
   \   00000000   00402DE9           PUSH     {LR}
    218            return (GetExtInfo(s,0,0,0,0)!=-1);
   \   00000004   0010A0E3           MOV      R1,#+0
   \   00000008   02002DE9           PUSH     {R1}
   \   0000000C   0030A0E3           MOV      R3,#+0
   \   00000010   0120A0E1           MOV      R2,R1
   \   00000014   ........           BL       ??GetExtInfo
   \   00000018   010070E3           CMN      R0,#+1
   \   0000001C   04D08DE2           ADD      SP,SP,#+4
   \   00000020   0100A013           MOVNE    R0,#+1
   \   00000024   0080BD18           POPNE    {PC}
   \   00000028   0000A0E3           MOV      R0,#+0
   \   0000002C   0080BDE8           POP      {PC}             ;; return
    219          }
    220          
    221          // ============================= INI ================================

   \                                 In segment CODE, align 4, keep-with-next
    222          void SaveIni(MyBOOK *mbk)
    223          {
   \                     ??SaveIni:
   \   00000000   F0432DE9           PUSH     {R4-R9,LR}
   \   00000004   40DF4DE2           SUB      SP,SP,#+256
   \   00000008   0040A0E1           MOV      R4,R0
    224            wchar_t path[128];
    225            wstrcpy(path,GetDir(DIR_ELFS_CONFIG | MEM_INTERNAL));
   \   0000000C   1500A0E3           MOV      R0,#+21
   \   00000010   050100EF           SWI      +261
   \   00000014   0010A0E1           MOV      R1,R0
   \   00000018   0D00A0E1           MOV      R0,SP
   \   0000001C   520100EF           SWI      +338
    226            wstrcat(path,L"/Extension/ext.ini");
   \   00000020   ........           LDR      R1,??DataTable1  ;; `?<Constant L"\\x2f\\x45\\x78\\x74\\x65\\x6e\\x73\\x69\\_1`
   \   00000024   0D00A0E1           MOV      R0,SP
   \   00000028   540100EF           SWI      +340
    227            int ihigh='0', ilow='0';
   \   0000002C   3050A0E3           MOV      R5,#+48
   \   00000030   3060A0E3           MOV      R6,#+48
    228            int f;
    229            if ((f=w_fopen(path, WA_Write|WA_Create|WA_Truncate, 0x1FF, NULL)) >=0){
   \   00000034   0030A0E3           MOV      R3,#+0
   \   00000038   FF20A0E3           MOV      R2,#+255
   \   0000003C   402F82E3           ORR      R2,R2,#0x100
   \   00000040   4A10A0E3           MOV      R1,#+74
   \   00000044   0D00A0E1           MOV      R0,SP
   \   00000048   F80200EF           SWI      +760
   \   0000004C   0090B0E1           MOVS     R9,R0
   \   00000050   3C00004A           BMI      ??SaveIni_1
    230              for(int i=0; i<mbk->astr->FirstFree; i++)
   \   00000054   240094E5           LDR      R0,[R4, #+36]
   \   00000058   0070A0E3           MOV      R7,#+0
   \   0000005C   B200D0E1           LDRH     R0,[R0, #+2]
   \   00000060   000050E3           CMP      R0,#+0
   \   00000064   3100001A           BNE      ??SaveIni_2
   \   00000068   340000EA           B        ??SaveIni_3
    231              {
    232                char *str=(char *)List_Get(mbk->astr,i);
   \                     ??SaveIni_4:
   \   0000006C   240094E5           LDR      R0,[R4, #+36]
   \   00000070   0710A0E1           MOV      R1,R7
   \   00000074   AD0100EF           SWI      +429
    233                char *s=str;
   \   00000078   0010D0E5           LDRB     R1,[R0, #+0]
   \   0000007C   0080A0E1           MOV      R8,R0
   \   00000080   200051E3           CMP      R1,#+32
   \   00000084   0200001A           BNE      ??SaveIni_5
    234                while(*s==' ') s++; 
   \                     ??SaveIni_6:
   \   00000088   0110F0E5           LDRB     R1,[R0, #+1]!
   \   0000008C   200051E3           CMP      R1,#+32
   \   00000090   FCFFFF0A           BEQ      ??SaveIni_6
    235                if (s[0]=='[' && s[1]=='E' && s[2]=='X' && s[3]=='T' &&
    236                  IsDigit(s[4]) && IsDigit(s[5]) && s[6]==']')
   \                     ??SaveIni_5:
   \   00000094   0010D0E5           LDRB     R1,[R0, #+0]
   \   00000098   5B0051E3           CMP      R1,#+91
   \   0000009C   0110D005           LDRBEQ   R1,[R0, #+1]
   \   000000A0   45005103           CMPEQ    R1,#+69
   \   000000A4   0210D005           LDRBEQ   R1,[R0, #+2]
   \   000000A8   58005103           CMPEQ    R1,#+88
   \   000000AC   0310D005           LDRBEQ   R1,[R0, #+3]
   \   000000B0   54005103           CMPEQ    R1,#+84
   \   000000B4   1200001A           BNE      ??SaveIni_7
   \   000000B8   0410D0E5           LDRB     R1,[R0, #+4]
   \   000000BC   300051E3           CMP      R1,#+48
   \   000000C0   0F0000BA           BLT      ??SaveIni_7
   \   000000C4   3A0051E3           CMP      R1,#+58
   \   000000C8   0D0000AA           BGE      ??SaveIni_7
   \   000000CC   0510D0E5           LDRB     R1,[R0, #+5]
   \   000000D0   300051E3           CMP      R1,#+48
   \   000000D4   0A0000BA           BLT      ??SaveIni_7
   \   000000D8   3A0051E3           CMP      R1,#+58
   \   000000DC   080000AA           BGE      ??SaveIni_7
   \   000000E0   0610D0E5           LDRB     R1,[R0, #+6]
   \   000000E4   5D0051E3           CMP      R1,#+93
   \   000000E8   0500001A           BNE      ??SaveIni_7
    237                {
    238                  s[4]=ihigh;
   \   000000EC   0450C0E5           STRB     R5,[R0, #+4]
    239                  s[5]=ilow;
   \   000000F0   0560C0E5           STRB     R6,[R0, #+5]
    240                  ilow++;
   \   000000F4   016086E2           ADD      R6,R6,#+1
    241                  if (ilow>'9') {ihigh++; ilow='0';}
   \   000000F8   3A0056E3           CMP      R6,#+58
   \   000000FC   015085A2           ADDGE    R5,R5,#+1
   \   00000100   3060A0A3           MOVGE    R6,#+48
    242                }
    243                w_fwrite(f,str,strlen(str));
   \                     ??SaveIni_7:
   \   00000104   0800A0E1           MOV      R0,R8
   \   00000108   5A0100EF           SWI      +346
   \   0000010C   0020A0E1           MOV      R2,R0
   \   00000110   0810A0E1           MOV      R1,R8
   \   00000114   0900A0E1           MOV      R0,R9
   \   00000118   FA0200EF           SWI      +762
    244                w_fwrite(f,(void *)"\r\n",2);
   \   0000011C   0220A0E3           MOV      R2,#+2
   \   00000120   0A1F8FE2           ADR      R1,??SaveIni_8   ;; "\r\n"
   \   00000124   0900A0E1           MOV      R0,R9
   \   00000128   FA0200EF           SWI      +762
    245              }
   \   0000012C   017087E2           ADD      R7,R7,#+1
   \                     ??SaveIni_2:
   \   00000130   240094E5           LDR      R0,[R4, #+36]
   \   00000134   B200D0E1           LDRH     R0,[R0, #+2]
   \   00000138   000057E1           CMP      R7,R0
   \   0000013C   CAFFFFBA           BLT      ??SaveIni_4
    246              w_fclose(f);
   \                     ??SaveIni_3:
   \   00000140   0900A0E1           MOV      R0,R9
   \   00000144   FD0200EF           SWI      +765
    247            }
    248          }
   \                     ??SaveIni_1:
   \   00000148   40DF8DE2           ADD      SP,SP,#+256      ;; stack cleaning
   \   0000014C   F083BDE8           POP      {R4-R9,PC}       ;; return
   \                     ??SaveIni_8:
   \   00000150   0D0A0000           DC8      "\r\n",+0
    249          

   \                                 In segment CODE, align 4, keep-with-next
    250          void ReadIni(MyBOOK *mbk)
    251          {
   \                     ??ReadIni:
   \   00000000   30402DE9           PUSH     {R4,R5,LR}
   \   00000004   41DF4DE2           SUB      SP,SP,#+260
   \   00000008   0040A0E1           MOV      R4,R0
    252            wchar_t path[128];
    253            wstrcpy(path,GetDir(DIR_ELFS_CONFIG | MEM_INTERNAL));
   \   0000000C   1500A0E3           MOV      R0,#+21
   \   00000010   050100EF           SWI      +261
   \   00000014   0010A0E1           MOV      R1,R0
   \   00000018   04008DE2           ADD      R0,SP,#+4
   \   0000001C   520100EF           SWI      +338
    254            wstrcat(path,L"/Extension/ext.ini");
   \   00000020   ........           LDR      R1,??DataTable1  ;; `?<Constant L"\\x2f\\x45\\x78\\x74\\x65\\x6e\\x73\\x69\\_1`
   \   00000024   04008DE2           ADD      R0,SP,#+4
   \   00000028   540100EF           SWI      +340
    255            int f;
    256            if ((f=w_fopen(path, WA_Read, 0x1FF, NULL)) >=0){
   \   0000002C   0030A0E3           MOV      R3,#+0
   \   00000030   FF20A0E3           MOV      R2,#+255
   \   00000034   402F82E3           ORR      R2,R2,#0x100
   \   00000038   0110A0E3           MOV      R1,#+1
   \   0000003C   04008DE2           ADD      R0,SP,#+4
   \   00000040   F80200EF           SWI      +760
   \   00000044   0050B0E1           MOVS     R5,R0
   \   00000048   2F00004A           BMI      ??ReadIni_1
    257              mbk->ebuf_len=w_lseek(f,0,WSEEK_END);
   \   0000004C   0120A0E3           MOV      R2,#+1
   \   00000050   0010A0E3           MOV      R1,#+0
   \   00000054   FC0200EF           SWI      +764
   \   00000058   200084E5           STR      R0,[R4, #+32]
    258              if (mbk->ebuf_len>0) {
   \   0000005C   010050E3           CMP      R0,#+1
   \   00000060   120000BA           BLT      ??ReadIni_2
    259                w_lseek(f,0,WSEEK_SET);
   \   00000064   0220A0E3           MOV      R2,#+2
   \   00000068   0010A0E3           MOV      R1,#+0
   \   0000006C   0500A0E1           MOV      R0,R5
   \   00000070   FC0200EF           SWI      +764
    260                if (mbk->ebuf) delete mbk->ebuf;
   \   00000074   1C0094E5           LDR      R0,[R4, #+28]
   \   00000078   000050E3           CMP      R0,#+0
   \   0000007C   0000000A           BEQ      ??ReadIni_3
   \   00000080   ........           _BLF     `??operator delete`,`??operator delete??rA`
    261                mbk->ebuf=new char[mbk->ebuf_len+1];
   \                     ??ReadIni_3:
   \   00000084   200094E5           LDR      R0,[R4, #+32]
   \   00000088   010080E2           ADD      R0,R0,#+1
   \   0000008C   ........           _BLF     `??operator new[]`,`??operator new[]??rA`
   \   00000090   1C0084E5           STR      R0,[R4, #+28]
    262                mbk->ebuf[w_fread(f,mbk->ebuf,mbk->ebuf_len)]=0;
   \   00000094   202094E5           LDR      R2,[R4, #+32]
   \   00000098   0010A0E1           MOV      R1,R0
   \   0000009C   0500A0E1           MOV      R0,R5
   \   000000A0   FB0200EF           SWI      +763
   \   000000A4   1C1094E5           LDR      R1,[R4, #+28]
   \   000000A8   0020A0E3           MOV      R2,#+0
   \   000000AC   0120C0E7           STRB     R2,[R0, +R1]
    263              }
    264              w_fclose(f);
   \                     ??ReadIni_2:
   \   000000B0   0500A0E1           MOV      R0,R5
   \   000000B4   FD0200EF           SWI      +765
    265              DestroyStringList(mbk);
   \   000000B8   0400A0E1           MOV      R0,R4
   \   000000BC   ........           BL       ??DestroyStringList
    266              char *s=mbk->ebuf;
   \   000000C0   1C5094E5           LDR      R5,[R4, #+28]
    267              int skip=0;
   \   000000C4   0010A0E3           MOV      R1,#+0
   \   000000C8   00108DE5           STR      R1,[SP, #+0]
   \   000000CC   010000EA           B        ??ReadIni_4
    268              do {
    269                s+=skip;
    270                if (!*s) break;  // не фиг последнюю строку добавлять если ее нету
    271                List_InsertLast(mbk->astr, s);
    272                s=find_eol(s, &skip);
    273                if (s) *s=0;
   \                     ??ReadIni_5:
   \   000000D0   0000A0E3           MOV      R0,#+0
   \   000000D4   0000C5E5           STRB     R0,[R5, #+0]
   \                     ??ReadIni_4:
   \   000000D8   00009DE5           LDR      R0,[SP, #+0]
   \   000000DC   055080E0           ADD      R5,R0,R5
   \   000000E0   0000D5E5           LDRB     R0,[R5, #+0]
   \   000000E4   000050E3           CMP      R0,#+0
   \   000000E8   0700000A           BEQ      ??ReadIni_1
   \   000000EC   240094E5           LDR      R0,[R4, #+36]
   \   000000F0   0510A0E1           MOV      R1,R5
   \   000000F4   B00100EF           SWI      +432
   \   000000F8   0D10A0E1           MOV      R1,SP
   \   000000FC   0500A0E1           MOV      R0,R5
   \   00000100   ........           BL       ??find_eol
   \   00000104   0050B0E1           MOVS     R5,R0
   \   00000108   F0FFFF1A           BNE      ??ReadIni_5
    274              } while(s);
    275              // Проверим какие строки нам нужны а какие пусть останутся как есть
    276            }
    277          }
   \                     ??ReadIni_1:
   \   0000010C   41DF8DE2           ADD      SP,SP,#+260      ;; stack cleaning
   \   00000110   3080BDE8           POP      {R4,R5,PC}       ;; return
    278          
    279          // ========================= DataBrowser ============================
    280          

   \                                 In segment CODE, align 4, keep-with-next
    281          int SelFileFilterElf(const wchar_t *ExtList, const wchar_t *ItemPath, const wchar_t *ItemName)
    282          {
   \                     ??SelFileFilterElf:
   \   00000000   30402DE9           PUSH     {R4,R5,LR}
   \   00000004   1CD04DE2           SUB      SP,SP,#+28
   \   00000008   0140A0E1           MOV      R4,R1
   \   0000000C   0250A0E1           MOV      R5,R2
    283            if (DataBrowser_isFileInListExt(ExtList,ItemPath,ItemName)) return(1);
   \   00000010   270100EF           SWI      +295
   \   00000014   000050E3           CMP      R0,#+0
   \   00000018   0200000A           BEQ      ??SelFileFilterElf_1
   \                     ??SelFileFilterElf_2:
   \   0000001C   0100A0E3           MOV      R0,#+1
   \   00000020   1CD08DE2           ADD      SP,SP,#+28
   \   00000024   3080BDE8           POP      {R4,R5,PC}
    284            FSTAT fs;
    285            fstat(ItemPath,ItemName,&fs);
   \                     ??SelFileFilterElf_1:
   \   00000028   0D20A0E1           MOV      R2,SP
   \   0000002C   0510A0E1           MOV      R1,R5
   \   00000030   0400A0E1           MOV      R0,R4
   \   00000034   1C0100EF           SWI      +284
    286            if ((fs.st_mode&FSX_S_IFDIR)) return(1);
   \   00000038   04009DE5           LDR      R0,[SP, #+4]
   \   0000003C   400B10E3           TST      R0,#0x10000
   \   00000040   F5FFFF1A           BNE      ??SelFileFilterElf_2
    287            return(0);
   \   00000044   0000A0E3           MOV      R0,#+0
   \   00000048   1CD08DE2           ADD      SP,SP,#+28
   \   0000004C   3080BDE8           POP      {R4,R5,PC}       ;; return
    288          }
    289          
    290          

   \                                 In segment CODE, align 4, keep-with-next
    291          static int SelFilePageOnCreate(void *, BOOK *bk)
    292          {
   \                     ??SelFilePageOnCreate:
   \   00000000   F0432DE9           PUSH     {R4-R9,LR}
   \   00000004   ACDF4DE2           SUB      SP,SP,#+688
   \   00000008   0160A0E1           MOV      R6,R1
    293            FILEITEM *fi=NULL;
   \   0000000C   0040A0E3           MOV      R4,#+0
    294            MyBOOK *mbk=(MyBOOK *)bk;
    295            void * DB_Desc=DataBrowserDesc_Create();
   \   00000010   1F0100EF           SWI      +287
   \   00000014   0050A0E1           MOV      R5,R0
    296            int folder_num;
    297            static wchar_t folderpics[128];
    298            const wchar_t * folder_list[2];
    299            wchar_t *filter;
    300            DB_FILE_FILTER filefilter;
    301            if (mbk->edit_list_selected==1)
   \   00000018   540196E5           LDR      R0,[R6, #+340]
   \   0000001C   010050E3           CMP      R0,#+1
   \   00000020   3500001A           BNE      ??SelFilePageOnCreate_1
    302            {
    303              W_FSTAT wf;
    304              wchar_t path[256];
    305              int res=-1;
    306              snwprintf(path, MAXELEMS(path)-1, L"%ls%s", GetDir(DIR_ELFS|MEM_INTERNAL), mbk->el_elf);
   \   00000024   1100A0E3           MOV      R0,#+17
   \   00000028   050100EF           SWI      +261
   \   0000002C   F4219FE5           LDR      R2,??SelFilePageOnCreate_2  ;; `?<Constant L"\\x2a\\x2e\\x70\\x6e\\x67\\x3b\\x2a\\x2e\\` + 52
   \   00000030   541086E2           ADD      R1,R6,#+84
   \   00000034   02002DE9           PUSH     {R1}
   \   00000038   0030A0E1           MOV      R3,R0
   \   0000003C   0C008DE2           ADD      R0,SP,#+12
   \   00000040   FF10A0E3           MOV      R1,#+255
   \   00000044   150100EF           SWI      +277
    307              if ((res=w_fstat(path,&wf)))
   \   00000048   A31F8DE2           ADD      R1,SP,#+652
   \   0000004C   0C008DE2           ADD      R0,SP,#+12
   \   00000050   F90200EF           SWI      +761
   \   00000054   000050E3           CMP      R0,#+0
   \   00000058   04D08DE2           ADD      SP,SP,#+4
   \   0000005C   0C00000A           BEQ      ??SelFilePageOnCreate_3
    308              {
    309                snwprintf(path, MAXELEMS(path)-1, L"%ls%s", GetDir(DIR_ELFS|MEM_EXTERNAL), mbk->el_elf);
   \   00000060   1000A0E3           MOV      R0,#+16
   \   00000064   050100EF           SWI      +261
   \   00000068   B8219FE5           LDR      R2,??SelFilePageOnCreate_2  ;; `?<Constant L"\\x2a\\x2e\\x70\\x6e\\x67\\x3b\\x2a\\x2e\\` + 52
   \   0000006C   0030A0E1           MOV      R3,R0
   \   00000070   540086E2           ADD      R0,R6,#+84
   \   00000074   01002DE9           PUSH     {R0}
   \   00000078   FF10A0E3           MOV      R1,#+255
   \   0000007C   0C008DE2           ADD      R0,SP,#+12
   \   00000080   150100EF           SWI      +277
    310                res=w_fstat(path,&wf);
   \   00000084   A31F8DE2           ADD      R1,SP,#+652
   \   00000088   0C008DE2           ADD      R0,SP,#+12
   \   0000008C   F90200EF           SWI      +761
   \   00000090   04D08DE2           ADD      SP,SP,#+4
    311              }
    312              if (!res)
   \                     ??SelFilePageOnCreate_3:
   \   00000094   000050E3           CMP      R0,#+0
   \   00000098   0D00001A           BNE      ??SelFilePageOnCreate_4
    313              {
    314                
    315                wchar_t *fname=wstrrchr(path, L'/');
   \   0000009C   2F10A0E3           MOV      R1,#+47
   \   000000A0   08008DE2           ADD      R0,SP,#+8
   \   000000A4   AE0100EF           SWI      +430
   \   000000A8   0070B0E1           MOVS     R7,R0
    316                if (fname)
   \   000000AC   0800000A           BEQ      ??SelFilePageOnCreate_4
    317                {
    318                  *fname++=0;
   \   000000B0   0000A0E3           MOV      R0,#+0
   \   000000B4   ........           STRH     R0,[R7], #+2
    319                  fi=FILEITEM_Create();
   \   000000B8   B30200EF           SWI      +691
   \   000000BC   0040A0E1           MOV      R4,R0
    320                  FILEITEM_SetPathAndContentType(fi, path);
   \   000000C0   08108DE2           ADD      R1,SP,#+8
   \   000000C4   D50200EF           SWI      +725
    321                  FILEITEM_SetFnameAndContentType(fi, fname);
   \   000000C8   0710A0E1           MOV      R1,R7
   \   000000CC   0400A0E1           MOV      R0,R4
   \   000000D0   D40200EF           SWI      +724
    322                }
    323              }
    324              folder_list[0]=GetDir(DIR_ELFS|MEM_INTERNAL);
    325              folder_list[1]=GetDir(DIR_ELFS|MEM_EXTERNAL);
    326              folder_num=2;
    327              filter=L"*.elf";
   \                     ??SelFilePageOnCreate_4:
   \   000000D4   50819FE5           LDR      R8,??SelFilePageOnCreate_2+0x4  ;; `?<Constant L"\\x2a\\x2e\\x70\\x6e\\x67\\x3b\\x2a\\x2e\\` + 64
    328              filefilter=SelFileFilterElf;
   \   000000D8   50919FE5           LDR      R9,??SelFilePageOnCreate_2+0x8  ;; ??SelFileFilterElf
   \   000000DC   1100A0E3           MOV      R0,#+17
   \   000000E0   050100EF           SWI      +261
   \   000000E4   00008DE5           STR      R0,[SP, #+0]
   \   000000E8   1000A0E3           MOV      R0,#+16
   \   000000EC   050100EF           SWI      +261
   \   000000F0   04008DE5           STR      R0,[SP, #+4]
   \   000000F4   0270A0E3           MOV      R7,#+2
   \   000000F8   200000EA           B        ??SelFilePageOnCreate_5
    329            }
    330            else if (mbk->edit_list_selected==2 || mbk->edit_list_selected==3)
   \                     ??SelFilePageOnCreate_1:
   \   000000FC   020050E3           CMP      R0,#+2
   \   00000100   03005013           CMPNE    R0,#+3
   \   00000104   1D00001A           BNE      ??SelFilePageOnCreate_5
    331            {
    332              wchar_t fname[64];
    333              char *s;
    334              fi=FILEITEM_Create();
    335              wstrcpy(folderpics,GetDir(DIR_ELFS_CONFIG | MEM_INTERNAL));
   \   00000108   24719FE5           LDR      R7,??SelFilePageOnCreate_2+0xC  ;; ??folderpics
    336              wstrcat(folderpics,L"/Extension");
    337              FILEITEM_SetPathAndContentType(fi, folderpics);
    338              s=mbk->edit_list_selected==2?mbk->el_smicon: mbk->el_bicon;
    339              win12512unicode(fname,s ,MAXELEMS(fname)-1);
    340              FILEITEM_SetFnameAndContentType(fi, fname);
    341              folder_list[0]=folderpics;
    342              folder_num=1;
    343              filter=L"*.png;*.gif;*.jpg;*.jpeg";
   \   0000010C   24819FE5           LDR      R8,??SelFilePageOnCreate_2+0x10  ;; `?<Constant L"\\x2a\\x2e\\x70\\x6e\\x67\\x3b\\x2a\\x2e\\`
   \   00000110   B30200EF           SWI      +691
   \   00000114   0040A0E1           MOV      R4,R0
   \   00000118   1500A0E3           MOV      R0,#+21
   \   0000011C   050100EF           SWI      +261
   \   00000120   0010A0E1           MOV      R1,R0
   \   00000124   0700A0E1           MOV      R0,R7
   \   00000128   520100EF           SWI      +338
   \   0000012C   08119FE5           LDR      R1,??SelFilePageOnCreate_2+0x14  ;; `?<Constant L"\\x2a\\x2e\\x70\\x6e\\x67\\x3b\\x2a\\x2e\\` + 76
   \   00000130   0700A0E1           MOV      R0,R7
   \   00000134   540100EF           SWI      +340
   \   00000138   0710A0E1           MOV      R1,R7
   \   0000013C   0400A0E1           MOV      R0,R4
   \   00000140   D50200EF           SWI      +725
   \   00000144   540196E5           LDR      R0,[R6, #+340]
   \   00000148   3F20A0E3           MOV      R2,#+63
   \   0000014C   020050E3           CMP      R0,#+2
   \   00000150   D4108602           ADDEQ    R1,R6,#+212
   \   00000154   451F8612           ADDNE    R1,R6,#+276
   \   00000158   820F8DE2           ADD      R0,SP,#+520
   \   0000015C   ........           BL       ??win12512unicode
   \   00000160   821F8DE2           ADD      R1,SP,#+520
   \   00000164   0400A0E1           MOV      R0,R4
   \   00000168   D40200EF           SWI      +724
   \   0000016C   C0109FE5           LDR      R1,??SelFilePageOnCreate_2+0xC  ;; ??folderpics
   \   00000170   0170A0E3           MOV      R7,#+1
   \   00000174   00108DE5           STR      R1,[SP, #+0]
    344              filefilter=DataBrowser_isFileInListExt_adr();
   \   00000178   278100EF           SWI      +33063
   \   0000017C   0090A0E1           MOV      R9,R0
    345            }
    346            DataBrowserDesc_SetHeaderText(DB_Desc,TextID_Create(L"SelectFile",ENC_UCS2,TEXTID_ANY_LEN));
   \                     ??SelFilePageOnCreate_5:
   \   00000180   B8009FE5           LDR      R0,??SelFilePageOnCreate_2+0x18  ;; `?<Constant L"\\x2a\\x2e\\x70\\x6e\\x67\\x3b\\x2a\\x2e\\` + 100
   \   00000184   FF20A0E3           MOV      R2,#+255
   \   00000188   FF2C82E3           ORR      R2,R2,#0xFF00
   \   0000018C   0010A0E3           MOV      R1,#+0
   \   00000190   5D0100EF           SWI      +349
   \   00000194   0010A0E1           MOV      R1,R0
   \   00000198   0500A0E1           MOV      R0,R5
   \   0000019C   210100EF           SWI      +289
    347            DataBrowserDesc_SetBookID(DB_Desc,BookObj_GetBookID(&mbk->book));
   \   000001A0   0600A0E1           MOV      R0,R6
   \   000001A4   FA0100EF           SWI      +506
   \   000001A8   0010A0E1           MOV      R1,R0
   \   000001AC   0500A0E1           MOV      R0,R5
   \   000001B0   AD0200EF           SWI      +685
    348            DataBrowserDesc_SetFolders(DB_Desc,folder_list);
   \   000001B4   0D10A0E1           MOV      R1,SP
   \   000001B8   0500A0E1           MOV      R0,R5
   \   000001BC   220100EF           SWI      +290
    349            DataBrowserDesc_SetFoldersNumber(DB_Desc,folder_num);
   \   000001C0   0710A0E1           MOV      R1,R7
   \   000001C4   0500A0E1           MOV      R0,R5
   \   000001C8   A90200EF           SWI      +681
    350          
    351            DataBrowserDesc_SetSelectAction(DB_Desc,1);
   \   000001CC   0110A0E3           MOV      R1,#+1
   \   000001D0   0500A0E1           MOV      R0,R5
   \   000001D4   AB0200EF           SWI      +683
    352            DataBrowserDesc_SetFileExtList(DB_Desc,filter);
   \   000001D8   0810A0E1           MOV      R1,R8
   \   000001DC   0500A0E1           MOV      R0,R5
   \   000001E0   B10200EF           SWI      +689
    353            DataBrowserDesc_SetItemFilter(DB_Desc,filefilter);
   \   000001E4   0910A0E1           MOV      R1,R9
   \   000001E8   0500A0E1           MOV      R0,R5
   \   000001EC   AE0200EF           SWI      +686
    354            if (fi){
   \   000001F0   000054E3           CMP      R4,#+0
   \   000001F4   0400000A           BEQ      ??SelFilePageOnCreate_6
    355              DataBrowserDesc_SetFocusToFILEITEM(DB_Desc, fi);
   \   000001F8   0410A0E1           MOV      R1,R4
   \   000001FC   0500A0E1           MOV      R0,R5
   \   00000200   730300EF           SWI      +883
    356              FILEITEM_Destroy(fi);
   \   00000204   0400A0E1           MOV      R0,R4
   \   00000208   B40200EF           SWI      +692
    357            }
    358            DataBrowser_Create(DB_Desc);
   \                     ??SelFilePageOnCreate_6:
   \   0000020C   0500A0E1           MOV      R0,R5
   \   00000210   240100EF           SWI      +292
    359            DataBrowserDesc_Destroy(DB_Desc);
   \   00000214   0500A0E1           MOV      R0,R5
   \   00000218   250100EF           SWI      +293
    360            return(1);
   \   0000021C   0100A0E3           MOV      R0,#+1
   \   00000220   ACDF8DE2           ADD      SP,SP,#+688
   \   00000224   F083BDE8           POP      {R4-R9,PC}       ;; return
   \                     ??SelFilePageOnCreate_2:
   \   00000228   ........           DC32     `?<Constant L"\\x2a\\x2e\\x70\\x6e\\x67\\x3b\\x2a\\x2e\\` + 52
   \   0000022C   ........           DC32     `?<Constant L"\\x2a\\x2e\\x70\\x6e\\x67\\x3b\\x2a\\x2e\\` + 64
   \   00000230   ........           DC32     ??SelFileFilterElf
   \   00000234   ........           DC32     ??folderpics
   \   00000238   ........           DC32     `?<Constant L"\\x2a\\x2e\\x70\\x6e\\x67\\x3b\\x2a\\x2e\\`
   \   0000023C   ........           DC32     `?<Constant L"\\x2a\\x2e\\x70\\x6e\\x67\\x3b\\x2a\\x2e\\` + 76
   \   00000240   ........           DC32     `?<Constant L"\\x2a\\x2e\\x70\\x6e\\x67\\x3b\\x2a\\x2e\\` + 100
    361          }

   \                                 In segment DATA_Z, align 4, align-sorted
   \                     ??folderpics:
   \   00000000                      DS8 256
    362          
    363          

   \                                 In segment CODE, align 4, keep-with-next
    364          static int SelFilePageOnAccept(void *data, BOOK *bk)
    365          {
   \                     ??SelFilePageOnAccept:
   \   00000000   F0412DE9           PUSH     {R4-R8,LR}
   \   00000004   0050A0E1           MOV      R5,R0
   \   00000008   0140A0E1           MOV      R4,R1
    366            MyBOOK *mbk=(MyBOOK *)bk;
    367            FILEITEM *file=(FILEITEM *)data;
    368            char *second_line=NULL;
    369            if (mbk->edit_list_selected==2 || mbk->edit_list_selected==3)
   \   0000000C   540194E5           LDR      R0,[R4, #+340]
   \   00000010   020050E3           CMP      R0,#+2
   \   00000014   03005013           CMPNE    R0,#+3
   \   00000018   0E00001A           BNE      ??SelFilePageOnAccept_1
    370            {
    371              if (mbk->edit_list_selected==2)
   \   0000001C   020050E3           CMP      R0,#+2
   \   00000020   0500A0E1           MOV      R0,R5
   \   00000024   0600001A           BNE      ??SelFilePageOnAccept_2
    372                unicode2win1251((second_line=mbk->el_smicon), FILEITEM_GetFname(file), sizeof(mbk->el_smicon)-1);
   \   00000028   D20200EF           SWI      +722
   \   0000002C   D45084E2           ADD      R5,R4,#+212
   \   00000030   3F20A0E3           MOV      R2,#+63
   \   00000034   0010A0E1           MOV      R1,R0
   \                     ??SelFilePageOnAccept_3:
   \   00000038   0500A0E1           MOV      R0,R5
   \   0000003C   ........           BL       ??unicode2win1251
   \   00000040   3A0000EA           B        ??SelFilePageOnAccept_4
    373              else
    374                unicode2win1251((second_line=mbk->el_bicon), FILEITEM_GetFname(file), sizeof(mbk->el_bicon)-1);
   \                     ??SelFilePageOnAccept_2:
   \   00000044   D20200EF           SWI      +722
   \   00000048   0010A0E1           MOV      R1,R0
   \   0000004C   455F84E2           ADD      R5,R4,#+276
   \   00000050   3F20A0E3           MOV      R2,#+63
   \   00000054   F7FFFFEA           B        ??SelFilePageOnAccept_3
    375            }
    376            else if (mbk->edit_list_selected==1)
   \                     ??SelFilePageOnAccept_1:
   \   00000058   010050E3           CMP      R0,#+1
   \   0000005C   3E00001A           BNE      ??SelFilePageOnAccept_5
    377            {
    378              wchar_t *p, *f;
    379              int pl;
    380              int len=(pl=wstrlen((p=FILEITEM_GetPath(file))))+wstrlen((f=FILEITEM_GetFname(file)))+2;
   \   00000060   0500A0E1           MOV      R0,R5
   \   00000064   D30200EF           SWI      +723
   \   00000068   0070A0E1           MOV      R7,R0
   \   0000006C   570100EF           SWI      +343
   \   00000070   0080A0E1           MOV      R8,R0
   \   00000074   0500A0E1           MOV      R0,R5
   \   00000078   D20200EF           SWI      +722
   \   0000007C   0060A0E1           MOV      R6,R0
   \   00000080   570100EF           SWI      +343
   \   00000084   080080E0           ADD      R0,R0,R8
   \   00000088   020080E2           ADD      R0,R0,#+2
    381              wchar_t *path=new wchar_t[len];
   \   0000008C   8000A0E1           LSL      R0,R0,#+1
   \   00000090   ........           _BLF     `??operator new[]`,`??operator new[]??rA`
   \   00000094   0050A0E1           MOV      R5,R0
    382              wstrcpy(path,p);
   \   00000098   0710A0E1           MOV      R1,R7
   \   0000009C   520100EF           SWI      +338
    383              path[pl++]='/';
   \   000000A0   880085E0           ADD      R0,R5,R8, LSL #+1
   \   000000A4   2F10A0E3           MOV      R1,#+47
   \   000000A8   ........           STRH     R1,[R0], #+2
    384              wstrcpy(path+pl, f);
   \   000000AC   0610A0E1           MOV      R1,R6
   \   000000B0   520100EF           SWI      +338
    385              p=GetDir(DIR_ELFS|MEM_INTERNAL);
   \   000000B4   1100A0E3           MOV      R0,#+17
   \   000000B8   050100EF           SWI      +261
   \   000000BC   0060A0E1           MOV      R6,R0
    386              f=GetDir(DIR_ELFS|MEM_EXTERNAL);
   \   000000C0   1000A0E3           MOV      R0,#+16
   \   000000C4   050100EF           SWI      +261
   \   000000C8   0070A0E1           MOV      R7,R0
    387              if (!wstrcmpni(p, path, (pl=wstrlen(p))))
   \   000000CC   0600A0E1           MOV      R0,R6
   \   000000D0   570100EF           SWI      +343
   \   000000D4   0080A0E1           MOV      R8,R0
   \   000000D8   0820A0E1           MOV      R2,R8
   \   000000DC   0510A0E1           MOV      R1,R5
   \   000000E0   0600A0E1           MOV      R0,R6
   \   000000E4   9A0200EF           SWI      +666
   \   000000E8   000050E3           CMP      R0,#+0
   \   000000EC   0800000A           BEQ      ??SelFilePageOnAccept_6
    388                unicode2win1251(mbk->el_elf, path+pl, sizeof(mbk->el_elf)-1);
    389              else if (!wstrcmpni(f, path, (pl=wstrlen(f))))
   \   000000F0   0700A0E1           MOV      R0,R7
   \   000000F4   570100EF           SWI      +343
   \   000000F8   0080A0E1           MOV      R8,R0
   \   000000FC   0820A0E1           MOV      R2,R8
   \   00000100   0510A0E1           MOV      R1,R5
   \   00000104   0700A0E1           MOV      R0,R7
   \   00000108   9A0200EF           SWI      +666
   \   0000010C   000050E3           CMP      R0,#+0
   \   00000110   0300001A           BNE      ??SelFilePageOnAccept_7
    390                unicode2win1251(mbk->el_elf, path+pl, sizeof(mbk->el_elf)-1);
   \                     ??SelFilePageOnAccept_6:
   \   00000114   7F20A0E3           MOV      R2,#+127
   \   00000118   881085E0           ADD      R1,R5,R8, LSL #+1
   \   0000011C   540084E2           ADD      R0,R4,#+84
   \   00000120   ........           BL       ??unicode2win1251
    391              delete path;
   \                     ??SelFilePageOnAccept_7:
   \   00000124   0500A0E1           MOV      R0,R5
   \   00000128   ........           _BLF     `??operator delete`,`??operator delete??rA`
    392              second_line=mbk->el_elf;
   \   0000012C   545084E2           ADD      R5,R4,#+84
    393            }
    394            if (second_line)
   \                     ??SelFilePageOnAccept_4:
   \   00000130   000055E3           CMP      R5,#+0
   \   00000134   0800000A           BEQ      ??SelFilePageOnAccept_5
    395              ListMenu_SetSecondLineText((GUI_LIST *)mbk->edit_list, mbk->edit_list_selected, TextID_Create(second_line,ENC_LAT1,TEXTID_ANY_LEN));
   \   00000138   FF20A0E3           MOV      R2,#+255
   \   0000013C   FF2C82E3           ORR      R2,R2,#0xFF00
   \   00000140   0610A0E3           MOV      R1,#+6
   \   00000144   0500A0E1           MOV      R0,R5
   \   00000148   5D0100EF           SWI      +349
   \   0000014C   541194E5           LDR      R1,[R4, #+340]
   \   00000150   0020A0E1           MOV      R2,R0
   \   00000154   280094E5           LDR      R0,[R4, #+40]
   \   00000158   A60200EF           SWI      +678
    396            BookObj_ReturnPage(bk, PREVIOUS_EVENT);
   \                     ??SelFilePageOnAccept_5:
   \   0000015C   ........           LDR      R0,??DataTable3  ;; PREVIOUS_EVENT
   \   00000160   001090E5           LDR      R1,[R0, #+0]
   \   00000164   0400A0E1           MOV      R0,R4
   \   00000168   2E0100EF           SWI      +302
    397            return(1);
   \   0000016C   0100A0E3           MOV      R0,#+1
   \   00000170   F081BDE8           POP      {R4-R8,PC}       ;; return
    398          }
    399          

   \                                 In segment CODE, align 4, keep-with-next
    400          static int SelFilePageOnCancel(void *data, BOOK *bk)
    401          {
   \                     ??SelFilePageOnCancel:
   \   00000000   00402DE9           PUSH     {LR}
   \   00000004   0100A0E1           MOV      R0,R1
    402            BookObj_ReturnPage(bk, PREVIOUS_EVENT);
   \   00000008   ........           LDR      R1,??DataTable3  ;; PREVIOUS_EVENT
   \   0000000C   001091E5           LDR      R1,[R1, #+0]
   \   00000010   2E0100EF           SWI      +302
    403            return(1);
   \   00000014   0100A0E3           MOV      R0,#+1
   \   00000018   0080BDE8           POP      {PC}             ;; return
    404          }
    405          

   \                                 In segment DYN_PAGE, align 4, align-sorted
    406          const PAGE_MSG bk_msglst_selfile[] @ "DYN_PAGE"  =
   \                     bk_msglst_selfile:
   \   00000000   42000000....       DC32 66, ??SelFilePageOnCreate, 76, ??SelFilePageOnAccept, 78
   \              ....4C000000
   \              ........4E00
   \              0000        
   \   00000014   ........4D00       DC32 ??SelFilePageOnCancel, 77, ??SelFilePageOnCancel, 64, 0H
   \              0000........
   \              400000000000
   \              0000        
    407          {
    408            PAGE_ENTER_EVENT_TAG,    SelFilePageOnCreate,
    409            ACCEPT_EVENT_TAG,        SelFilePageOnAccept,
    410            CANCEL_EVENT_TAG,        SelFilePageOnCancel,
    411            PREVIOUS_EVENT_TAG,      SelFilePageOnCancel,
    412            NIL_EVENT_TAG,           NULL
    413          };
    414          
    415          const PAGE_DESC bk_selbcfg = {"ExtEditor_SelectFile_Page",0,bk_msglst_selfile};
    416          
    417          // ========================= SI_EditExt =============================

   \                                 In segment CODE, align 4, keep-with-next
    418          void OnBackSI_EditExt(BOOK * bk, u16 *string, int len)
    419          {
   \                     ??OnBackSI_EditExt:
   \   00000000   10402DE9           PUSH     {R4,LR}
   \   00000004   0040A0E1           MOV      R4,R0
    420            MyBOOK * myBook=(MyBOOK *)bk;
    421            FREE_GUI(myBook->si_editext);
   \   00000008   580194E5           LDR      R0,[R4, #+344]
   \   0000000C   000050E3           CMP      R0,#+0
   \   00000010   1080BD08           POPEQ    {R4,PC}
   \   00000014   CE0100EF           SWI      +462
   \   00000018   580184E5           STR      R0,[R4, #+344]
    422          }
   \   0000001C   1080BDE8           POP      {R4,PC}          ;; return
    423          

   \                                 In segment CODE, align 4, keep-with-next
    424          void OnOkSI_EditExt(BOOK * bk, wchar_t *string, int len)
    425          {
   \                     ??OnOkSI_EditExt:
   \   00000000   10402DE9           PUSH     {R4,LR}
    426            MyBOOK * myBook=(MyBOOK *)bk;
    427            unicode2win1251(myBook->el_ext,string,MAXELEMS(myBook->el_ext)-1);
   \   00000004   2320A0E3           MOV      R2,#+35
   \   00000008   0040A0E1           MOV      R4,R0
   \   0000000C   300084E2           ADD      R0,R4,#+48
   \   00000010   ........           BL       ??unicode2win1251
    428            FREE_GUI(myBook->si_editext);
   \   00000014   580194E5           LDR      R0,[R4, #+344]
   \   00000018   000050E3           CMP      R0,#+0
   \   0000001C   1080BD08           POPEQ    {R4,PC}
   \   00000020   CE0100EF           SWI      +462
   \   00000024   580184E5           STR      R0,[R4, #+344]
    429          }
   \   00000028   1080BDE8           POP      {R4,PC}          ;; return
    430          

   \                                 In segment CODE, align 4, keep-with-next
    431          void CreateSI_EditExt(MyBOOK *myBook)
    432          {
   \                     ??CreateSI_EditExt:
   \   00000000   70402DE9           PUSH     {R4-R6,LR}
   \   00000004   0040A0E1           MOV      R4,R0
    433            wchar_t ustr[64];
    434            TEXTID text, header_name;
    435            header_name=TextID_Create(L"Input new ext",ENC_UCS2,TEXTID_ANY_LEN);
   \   00000008   C4009FE5           LDR      R0,??CreateSI_EditExt_1  ;; `?<Constant L"\\x49\\x6e\\x70\\x75\\x74\\x20\\x6e\\x65\\`
   \   0000000C   80D04DE2           SUB      SP,SP,#+128
   \   00000010   FF60A0E3           MOV      R6,#+255
   \   00000014   FF6C86E3           ORR      R6,R6,#0xFF00
   \   00000018   0620A0E1           MOV      R2,R6
   \   0000001C   0010A0E3           MOV      R1,#+0
   \   00000020   5D0100EF           SWI      +349
   \   00000024   0050A0E1           MOV      R5,R0
    436            win12512unicode(ustr,myBook->el_ext,MAXELEMS(ustr)-1);
   \   00000028   3F20A0E3           MOV      R2,#+63
   \   0000002C   301084E2           ADD      R1,R4,#+48
   \   00000030   0D00A0E1           MOV      R0,SP
   \   00000034   ........           BL       ??win12512unicode
    437            text=TextID_Create(ustr,ENC_UCS2,TEXTID_ANY_LEN);
   \   00000038   0620A0E1           MOV      R2,R6
   \   0000003C   0010A0E3           MOV      R1,#+0
   \   00000040   0D00A0E1           MOV      R0,SP
   \   00000044   5D0100EF           SWI      +349
    438            myBook->si_editext = CreateStringInputVA(0,
    439                                                        VAR_HEADER_TEXT(header_name),
    440                                                        VAR_STRINP_MIN_LEN(0),
    441                                                        VAR_STRINP_MAX_LEN(35),
    442                                                        VAR_STRINP_MODE(1),
    443                                                        VAR_BOOK(myBook),
    444                                                        VAR_STRINP_TEXT(text),
    445                                                        VAR_PREV_ACTION_PROC(OnBackSI_EditExt),
    446                                                        VAR_OK_PROC(OnOkSI_EditExt),
    447                                                        0);
   \   00000048   88309FE5           LDR      R3,??CreateSI_EditExt_1+0x4  ;; VAR_ARG_STRINP_MIN_LEN
   \   0000004C   0010A0E3           MOV      R1,#+0
   \   00000050   02002DE9           PUSH     {R1}
   \   00000054   80109FE5           LDR      R1,??CreateSI_EditExt_1+0x8  ;; ??OnOkSI_EditExt
   \   00000058   0520A0E1           MOV      R2,R5
   \   0000005C   02002DE9           PUSH     {R1}
   \   00000060   78109FE5           LDR      R1,??CreateSI_EditExt_1+0xC  ;; VAR_ARG_CALL_BACK_OK
   \   00000064   02002DE9           PUSH     {R1}
   \   00000068   74109FE5           LDR      R1,??CreateSI_EditExt_1+0x10  ;; ??OnBackSI_EditExt
   \   0000006C   02002DE9           PUSH     {R1}
   \   00000070   ........           LDR      R1,??DataTable6  ;; VAR_ARG_CALL_BACK_PREV_ACT
   \   00000074   02002DE9           PUSH     {R1}
   \   00000078   68109FE5           LDR      R1,??CreateSI_EditExt_1+0x14  ;; VAR_ARG_HTEXT
   \   0000007C   01002DE9           PUSH     {R0}
   \   00000080   64009FE5           LDR      R0,??CreateSI_EditExt_1+0x18  ;; VAR_ARG_STRINP_TEXT
   \   00000084   01002DE9           PUSH     {R0}
   \   00000088   0400A0E1           MOV      R0,R4
   \   0000008C   01002DE9           PUSH     {R0}
   \   00000090   ........           LDR      R0,??DataTable7  ;; VAR_ARG_BOOK
   \   00000094   01002DE9           PUSH     {R0}
   \   00000098   0100A0E3           MOV      R0,#+1
   \   0000009C   01002DE9           PUSH     {R0}
   \   000000A0   48009FE5           LDR      R0,??CreateSI_EditExt_1+0x1C  ;; VAR_ARG_STRINP_MODE
   \   000000A4   01002DE9           PUSH     {R0}
   \   000000A8   2300A0E3           MOV      R0,#+35
   \   000000AC   01002DE9           PUSH     {R0}
   \   000000B0   3C009FE5           LDR      R0,??CreateSI_EditExt_1+0x20  ;; VAR_ARG_STRINP_MAX_LEN
   \   000000B4   01002DE9           PUSH     {R0}
   \   000000B8   0000A0E3           MOV      R0,#+0
   \   000000BC   01002DE9           PUSH     {R0}
   \   000000C0   440100EF           SWI      +324
   \   000000C4   38D08DE2           ADD      SP,SP,#+56
   \   000000C8   580184E5           STR      R0,[R4, #+344]
    448          }
   \   000000CC   80D08DE2           ADD      SP,SP,#+128
   \   000000D0   7080BDE8           POP      {R4-R6,PC}       ;; return
   \                     ??CreateSI_EditExt_1:
   \   000000D4   ........           DC32     `?<Constant L"\\x49\\x6e\\x70\\x75\\x74\\x20\\x6e\\x65\\`
   \   000000D8   ........           DC32     VAR_ARG_STRINP_MIN_LEN
   \   000000DC   ........           DC32     ??OnOkSI_EditExt
   \   000000E0   ........           DC32     VAR_ARG_CALL_BACK_OK
   \   000000E4   ........           DC32     ??OnBackSI_EditExt
   \   000000E8   ........           DC32     VAR_ARG_HTEXT
   \   000000EC   ........           DC32     VAR_ARG_STRINP_TEXT
   \   000000F0   ........           DC32     VAR_ARG_STRINP_MODE
   \   000000F4   ........           DC32     VAR_ARG_STRINP_MAX_LEN
    449          // =========================== YesNoGui =============================

   \                                 In segment CODE, align 4, keep-with-next
    450          static void YSYes(BOOK * bk, void *)
    451          {
   \                     ??YSYes:
   \   00000000   10402DE9           PUSH     {R4,LR}
    452            MyBOOK *mcb=(MyBOOK *)bk;
    453            mcb->YesNoFunc(bk, 1);
   \   00000004   0110A0E3           MOV      R1,#+1
   \   00000008   0040A0E1           MOV      R4,R0
   \   0000000C   602194E5           LDR      R2,[R4, #+352]
   \   00000010   32FF2FE1           BLX      R2
    454            FREE_GUI(mcb->yes_no);
   \   00000014   5C0194E5           LDR      R0,[R4, #+348]
   \   00000018   000050E3           CMP      R0,#+0
   \   0000001C   1080BD08           POPEQ    {R4,PC}
   \   00000020   CE0100EF           SWI      +462
   \   00000024   5C0184E5           STR      R0,[R4, #+348]
    455          }
   \   00000028   1080BDE8           POP      {R4,PC}          ;; return
    456          

   \                                 In segment CODE, align 4, keep-with-next
    457          static void YSNo (BOOK * bk, void *)
    458          {
   \                     ??YSNo:
   \   00000000   10402DE9           PUSH     {R4,LR}
    459            MyBOOK *mcb=(MyBOOK *)bk;
    460            mcb->YesNoFunc(bk, 0);
   \   00000004   0010A0E3           MOV      R1,#+0
   \   00000008   0040A0E1           MOV      R4,R0
   \   0000000C   602194E5           LDR      R2,[R4, #+352]
   \   00000010   32FF2FE1           BLX      R2
    461            FREE_GUI(mcb->yes_no);
   \   00000014   5C0194E5           LDR      R0,[R4, #+348]
   \   00000018   000050E3           CMP      R0,#+0
   \   0000001C   1080BD08           POPEQ    {R4,PC}
   \   00000020   CE0100EF           SWI      +462
   \   00000024   5C0184E5           STR      R0,[R4, #+348]
    462          }
   \   00000028   1080BDE8           POP      {R4,PC}          ;; return
    463          

   \                                 In segment CODE, align 4, keep-with-next
    464          static void YSPrev (BOOK * bk, void *)
    465          {
   \                     ??YSPrev:
   \   00000000   10402DE9           PUSH     {R4,LR}
   \   00000004   0040A0E1           MOV      R4,R0
    466            MyBOOK *mcb=(MyBOOK *)bk;
    467            FREE_GUI(mcb->yes_no);
   \   00000008   5C0194E5           LDR      R0,[R4, #+348]
   \   0000000C   000050E3           CMP      R0,#+0
   \   00000010   1080BD08           POPEQ    {R4,PC}
   \   00000014   CE0100EF           SWI      +462
   \   00000018   5C0184E5           STR      R0,[R4, #+348]
    468          }
   \   0000001C   1080BDE8           POP      {R4,PC}          ;; return
    469          

   \                                 In segment CODE, align 4, keep-with-next
    470          void MsgBoxYesNo(MyBOOK *mbk, wchar_t *qv, void(*f)(BOOK *, int))
    471          {
   \                     ??MsgBoxYesNo:
   \   00000000   30402DE9           PUSH     {R4,R5,LR}
   \   00000004   0040A0E1           MOV      R4,R0
   \   00000008   0100A0E1           MOV      R0,R1
   \   0000000C   0250A0E1           MOV      R5,R2
    472            TEXTID q=TextID_Create(qv,ENC_UCS2,TEXTID_ANY_LEN);
   \   00000010   FF20A0E3           MOV      R2,#+255
   \   00000014   FF2C82E3           ORR      R2,R2,#0xFF00
   \   00000018   0010A0E3           MOV      R1,#+0
   \   0000001C   5D0100EF           SWI      +349
    473            mbk->YesNoFunc=f;
   \   00000020   605184E5           STR      R5,[R4, #+352]
    474            mbk->yes_no=CreateYesNoQuestionVA(0,
    475                                                 VAR_BOOK(mbk),
    476                                                 VAR_YESNO_QUESTION(q),
    477                                                 VAR_YESNO_YES_ACTION(YSYes),
    478                                                 VAR_YESNO_NO_ACTION(YSNo),
    479                                                 VAR_PREV_ACTION_PROC(YSPrev),
    480                                                 0);
   \   00000024   54309FE5           LDR      R3,??MsgBoxYesNo_1  ;; VAR_ARG_YESNO_QUESTION
   \   00000028   0010A0E3           MOV      R1,#+0
   \   0000002C   02002DE9           PUSH     {R1}
   \   00000030   4C109FE5           LDR      R1,??MsgBoxYesNo_1+0x4  ;; ??YSPrev
   \   00000034   0420A0E1           MOV      R2,R4
   \   00000038   02002DE9           PUSH     {R1}
   \   0000003C   ........           LDR      R1,??DataTable6  ;; VAR_ARG_CALL_BACK_PREV_ACT
   \   00000040   02002DE9           PUSH     {R1}
   \   00000044   3C109FE5           LDR      R1,??MsgBoxYesNo_1+0x8  ;; ??YSNo
   \   00000048   02002DE9           PUSH     {R1}
   \   0000004C   38109FE5           LDR      R1,??MsgBoxYesNo_1+0xC  ;; VAR_ARG_YESNO_NO_ACTION
   \   00000050   02002DE9           PUSH     {R1}
   \   00000054   34109FE5           LDR      R1,??MsgBoxYesNo_1+0x10  ;; ??YSYes
   \   00000058   02002DE9           PUSH     {R1}
   \   0000005C   30109FE5           LDR      R1,??MsgBoxYesNo_1+0x14  ;; VAR_ARG_YESNO_YES_ACTION
   \   00000060   02002DE9           PUSH     {R1}
   \   00000064   ........           LDR      R1,??DataTable7  ;; VAR_ARG_BOOK
   \   00000068   01002DE9           PUSH     {R0}
   \   0000006C   0000A0E3           MOV      R0,#+0
   \   00000070   A50200EF           SWI      +677
   \   00000074   5C0184E5           STR      R0,[R4, #+348]
    481          }
   \   00000078   20D08DE2           ADD      SP,SP,#+32
   \   0000007C   3080BDE8           POP      {R4,R5,PC}       ;; return
   \                     ??MsgBoxYesNo_1:
   \   00000080   ........           DC32     VAR_ARG_YESNO_QUESTION
   \   00000084   ........           DC32     ??YSPrev
   \   00000088   ........           DC32     ??YSNo
   \   0000008C   ........           DC32     VAR_ARG_YESNO_NO_ACTION
   \   00000090   ........           DC32     ??YSYes
   \   00000094   ........           DC32     VAR_ARG_YESNO_YES_ACTION
    482          // ========================= EditExtList ============================

   \                                 In segment CODE, align 4, keep-with-next
    483          void OnSelect1EditExtList(BOOK * bk, GUI* )
    484          {
   \                     ??OnSelect1EditExtList:
   \   00000000   10402DE9           PUSH     {R4,LR}
   \   00000004   0040A0E1           MOV      R4,R0
    485            MyBOOK * mbk=(MyBOOK *)bk;
    486            mbk->edit_list_selected=ListMenu_GetSelectedItem((GUI_LIST *)mbk->edit_list);
   \   00000008   280094E5           LDR      R0,[R4, #+40]
   \   0000000C   3E0100EF           SWI      +318
   \   00000010   540184E5           STR      R0,[R4, #+340]
    487            switch(mbk->edit_list_selected)
   \   00000014   000050E3           CMP      R0,#+0
   \   00000018   0300000A           BEQ      ??OnSelect1EditExtList_1
   \   0000001C   010040E2           SUB      R0,R0,#+1
   \   00000020   020050E3           CMP      R0,#+2
   \   00000024   0300009A           BLS      ??OnSelect1EditExtList_2
   \   00000028   1080BDE8           POP      {R4,PC}
    488            {
    489            case 0:  // Запускаем редактор...
    490              CreateSI_EditExt(mbk);
   \                     ??OnSelect1EditExtList_1:
   \   0000002C   0400A0E1           MOV      R0,R4
   \   00000030   1040BDE8           POP      {R4,LR}          ;; Pop
   \   00000034   ........           B        ??CreateSI_EditExt  ;; tailcall
    491              break;
    492              
    493            case 1:  // Дата браузер
    494            case 2:  // Ещё..
    495            case 3:  // и ещё..
    496              BookObj_CallPage(&mbk->book,&bk_selbcfg);
   \                     ??OnSelect1EditExtList_2:
   \   00000038   08109FE5           LDR      R1,??OnSelect1EditExtList_3  ;; bk_selbcfg
   \   0000003C   0400A0E1           MOV      R0,R4
   \   00000040   B80200EF           SWI      +696
    497              break;
    498            }
    499          }
   \   00000044   1080BDE8           POP      {R4,PC}          ;; return
   \                     ??OnSelect1EditExtList_3:
   \   00000048   ........           DC32     bk_selbcfg
    500          

   \                                 In segment CODE, align 4, keep-with-next
    501          void YesNoOnBackExt(BOOK * bk, int i)
    502          {
   \                     ??YesNoOnBackExt:
   \   00000000   30402DE9           PUSH     {R4,R5,LR}
   \   00000004   40DF4DE2           SUB      SP,SP,#+256
   \   00000008   0040A0E1           MOV      R4,R0
    503            MyBOOK * mbk=(MyBOOK *)bk;
    504            
    505            if (i==1)
   \   0000000C   010051E3           CMP      R1,#+1
   \   00000010   2300001A           BNE      ??YesNoOnBackExt_1
    506            {
    507              char tmp[256];
    508              int len=sprintf(tmp, "[EXT99]: %s, %s, %s, %s", mbk->el_ext,mbk->el_bicon,mbk->el_smicon,mbk->el_elf);
   \   00000014   A4109FE5           LDR      R1,??YesNoOnBackExt_2  ;; `?<Constant "[EXT99]: %s, %s, %s, %s">`
   \   00000018   540084E2           ADD      R0,R4,#+84
   \   0000001C   01002DE9           PUSH     {R0}
   \   00000020   453F84E2           ADD      R3,R4,#+276
   \   00000024   302084E2           ADD      R2,R4,#+48
   \   00000028   D40084E2           ADD      R0,R4,#+212
   \   0000002C   01002DE9           PUSH     {R0}
   \   00000030   08008DE2           ADD      R0,SP,#+8
   \   00000034   140100EF           SWI      +276
    509              char *newstr=new char[len+1];
   \   00000038   010080E2           ADD      R0,R0,#+1
   \   0000003C   ........           _BLF     `??operator new[]`,`??operator new[]??rA`
   \   00000040   0050A0E1           MOV      R5,R0
    510              strcpy(newstr,tmp);
   \   00000044   08108DE2           ADD      R1,SP,#+8
   \   00000048   A00100EF           SWI      +416
    511              if (mbk->edit_id!=-1)
   \   0000004C   2C0094E5           LDR      R0,[R4, #+44]
   \   00000050   08D08DE2           ADD      SP,SP,#+8
   \   00000054   010070E3           CMN      R0,#+1
   \   00000058   0A00000A           BEQ      ??YesNoOnBackExt_3
    512              {
    513                char *str=(char *)List_RemoveAt(mbk->astr,mbk->edit_id);
   \   0000005C   0010A0E1           MOV      R1,R0
   \   00000060   240094E5           LDR      R0,[R4, #+36]
   \   00000064   790100EF           SWI      +377
    514                SafeFreeString(mbk, str);
   \   00000068   0010A0E1           MOV      R1,R0
   \   0000006C   0400A0E1           MOV      R0,R4
   \   00000070   ........           BL       ??SafeFreeString
    515                List_Insert(mbk->astr, mbk->edit_id, newstr);
   \   00000074   2C1094E5           LDR      R1,[R4, #+44]
   \   00000078   240094E5           LDR      R0,[R4, #+36]
   \   0000007C   0520A0E1           MOV      R2,R5
   \   00000080   040300EF           SWI      +772
   \   00000084   020000EA           B        ??YesNoOnBackExt_4
    516              }
    517              else
    518              {
    519                List_InsertLast(mbk->astr, newstr);
   \                     ??YesNoOnBackExt_3:
   \   00000088   240094E5           LDR      R0,[R4, #+36]
   \   0000008C   0510A0E1           MOV      R1,R5
   \   00000090   B00100EF           SWI      +432
    520              }
    521              mbk->is_changed=1;
   \                     ??YesNoOnBackExt_4:
   \   00000094   0100A0E3           MOV      R0,#+1
   \   00000098   640184E5           STR      R0,[R4, #+356]
    522              CreateGuiList(mbk);
   \   0000009C   0400A0E1           MOV      R0,R4
   \   000000A0   ........           BL       ??CreateGuiList
    523            }
    524            FREE_GUI(mbk->edit_list);
   \                     ??YesNoOnBackExt_1:
   \   000000A4   280094E5           LDR      R0,[R4, #+40]
   \   000000A8   000050E3           CMP      R0,#+0
   \   000000AC   0100000A           BEQ      ??YesNoOnBackExt_5
   \   000000B0   CE0100EF           SWI      +462
   \   000000B4   280084E5           STR      R0,[R4, #+40]
    525          }
   \                     ??YesNoOnBackExt_5:
   \   000000B8   40DF8DE2           ADD      SP,SP,#+256      ;; stack cleaning
   \   000000BC   3080BDE8           POP      {R4,R5,PC}       ;; return
   \                     ??YesNoOnBackExt_2:
   \   000000C0   ........           DC32     `?<Constant "[EXT99]: %s, %s, %s, %s">`
    526          

   \                                 In segment CODE, align 4, keep-with-next
    527          void OnBackEditExtList(BOOK * bk, GUI* )
    528          {
   \                     ??OnBackEditExtList:
   \   00000000   10402DE9           PUSH     {R4,LR}
   \   00000004   49DF4DE2           SUB      SP,SP,#+292
   \   00000008   0040A0E1           MOV      R4,R0
    529            MyBOOK * mbk=(MyBOOK *)bk;
    530            int cmp=0;
    531            if (mbk->edit_id!=-1)
   \   0000000C   2C0094E5           LDR      R0,[R4, #+44]
   \   00000010   010070E3           CMN      R0,#+1
   \   00000014   1C00000A           BEQ      ??OnBackEditExtList_1
    532            {
    533              char *str=(char *)List_Get(mbk->astr,mbk->edit_id);
   \   00000018   0010A0E1           MOV      R1,R0
   \   0000001C   240094E5           LDR      R0,[R4, #+36]
   \   00000020   AD0100EF           SWI      +429
    534              char el_ext[36];
    535              char el_elf[128];
    536              char el_smicon[64];
    537              char el_bicon[64];
    538              GetExtInfo(str, el_ext, el_elf, el_smicon, el_bicon);
   \   00000024   C0108DE2           ADD      R1,SP,#+192
   \   00000028   02002DE9           PUSH     {R1}
   \   0000002C   84308DE2           ADD      R3,SP,#+132
   \   00000030   04208DE2           ADD      R2,SP,#+4
   \   00000034   411F8DE2           ADD      R1,SP,#+260
   \   00000038   ........           BL       ??GetExtInfo
    539              cmp=strcmp_nocase(el_ext,mbk->el_ext);
   \   0000003C   301084E2           ADD      R1,R4,#+48
   \   00000040   410F8DE2           ADD      R0,SP,#+260
   \   00000044   ........           BL       ??strcmp_nocase
    540              if (!cmp) cmp=strcmp_nocase(el_elf,mbk->el_elf);
   \   00000048   000050E3           CMP      R0,#+0
   \   0000004C   04D08DE2           ADD      SP,SP,#+4
   \   00000050   0200001A           BNE      ??OnBackEditExtList_2
   \   00000054   541084E2           ADD      R1,R4,#+84
   \   00000058   0D00A0E1           MOV      R0,SP
   \   0000005C   ........           BL       ??strcmp_nocase
    541              if (!cmp) cmp=strcmp_nocase(el_smicon,mbk->el_smicon);
   \                     ??OnBackEditExtList_2:
   \   00000060   000050E3           CMP      R0,#+0
   \   00000064   0200001A           BNE      ??OnBackEditExtList_3
   \   00000068   D41084E2           ADD      R1,R4,#+212
   \   0000006C   80008DE2           ADD      R0,SP,#+128
   \   00000070   ........           BL       ??strcmp_nocase
    542              if (!cmp) cmp=strcmp_nocase(el_bicon,mbk->el_bicon);
   \                     ??OnBackEditExtList_3:
   \   00000074   000050E3           CMP      R0,#+0
   \   00000078   0A00001A           BNE      ??OnBackEditExtList_4
   \   0000007C   451F84E2           ADD      R1,R4,#+276
   \   00000080   C0008DE2           ADD      R0,SP,#+192
   \   00000084   ........           BL       ??strcmp_nocase
   \   00000088   060000EA           B        ??OnBackEditExtList_4
    543            }
    544            else
    545            {
    546              cmp=*mbk->el_ext;
   \                     ??OnBackEditExtList_1:
   \   0000008C   3000D4E5           LDRB     R0,[R4, #+48]
    547              if (!cmp) cmp=*mbk->el_elf;
   \   00000090   000050E3           CMP      R0,#+0
   \   00000094   5400D405           LDRBEQ   R0,[R4, #+84]
    548              if (!cmp) cmp=*mbk->el_smicon;
   \   00000098   000050E3           CMP      R0,#+0
   \   0000009C   D400D405           LDRBEQ   R0,[R4, #+212]
    549              if (!cmp) cmp=*mbk->el_bicon;
   \   000000A0   000050E3           CMP      R0,#+0
   \   000000A4   1401D405           LDRBEQ   R0,[R4, #+276]
    550            }
    551            if (cmp)
   \                     ??OnBackEditExtList_4:
   \   000000A8   000050E3           CMP      R0,#+0
   \   000000AC   0500000A           BEQ      ??OnBackEditExtList_5
    552            {
    553              MsgBoxYesNo(mbk, L"Do you want to save changes?",YesNoOnBackExt);
   \   000000B0   2C209FE5           LDR      R2,??OnBackEditExtList_6  ;; ??YesNoOnBackExt
   \   000000B4   2C109FE5           LDR      R1,??OnBackEditExtList_6+0x4  ;; `?<Constant L"\\x44\\x6f\\x20\\x79\\x6f\\x75\\x20\\x77\\_1`
   \   000000B8   0400A0E1           MOV      R0,R4
   \   000000BC   ........           BL       ??MsgBoxYesNo
   \   000000C0   49DF8DE2           ADD      SP,SP,#+292
   \   000000C4   1080BDE8           POP      {R4,PC}
    554            }
    555            else
    556              FREE_GUI(mbk->edit_list);
   \                     ??OnBackEditExtList_5:
   \   000000C8   280094E5           LDR      R0,[R4, #+40]
   \   000000CC   000050E3           CMP      R0,#+0
   \   000000D0   0100000A           BEQ      ??OnBackEditExtList_7
   \   000000D4   CE0100EF           SWI      +462
   \   000000D8   280084E5           STR      R0,[R4, #+40]
    557          }
   \                     ??OnBackEditExtList_7:
   \   000000DC   49DF8DE2           ADD      SP,SP,#+292      ;; stack cleaning
   \   000000E0   1080BDE8           POP      {R4,PC}          ;; return
   \                     ??OnBackEditExtList_6:
   \   000000E4   ........           DC32     ??YesNoOnBackExt
   \   000000E8   ........           DC32     `?<Constant L"\\x44\\x6f\\x20\\x79\\x6f\\x75\\x20\\x77\\_1`
    558          
    559          // устанавливаем тексты в пунктах меню

   \                                 In segment CODE, align 4, keep-with-next
    560          int onLBMessageEditExtList(GUI_MESSAGE * msg)
    561          {
   \                     ??onLBMessageEditExtList:
   \   00000000   F0402DE9           PUSH     {R4-R7,LR}
   \   00000004   0040A0E1           MOV      R4,R0
    562            MyBOOK * myBook = (MyBOOK *)GUIonMessage_GetBook(msg);
    563            int item;
    564            char *str="";
   \   00000008   2C6F8FE2           ADR      R6,??onLBMessageEditExtList_1  ;; ""
    565            wchar_t *first_txt=L"";
   \   0000000C   2C7F8FE2           ADR      R7,??onLBMessageEditExtList_1+0x4  ;; 0x00, 0x00
   \   00000010   750300EF           SWI      +885
   \   00000014   0050A0E1           MOV      R5,R0
    566            switch( GUIonMessage_GetMsg(msg) )
   \   00000018   0400A0E1           MOV      R0,R4
   \   0000001C   740300EF           SWI      +884
   \   00000020   010050E3           CMP      R0,#+1
   \   00000024   2300001A           BNE      ??onLBMessageEditExtList_2
    567            {
    568              // onCreateListItem
    569            case 1:
    570              item=GUIonMessage_GetCreatedItemIndex(msg);
    571              switch(item)
   \   00000028   0400A0E1           MOV      R0,R4
   \   0000002C   370100EF           SWI      +311
   \   00000030   000050E3           CMP      R0,#+0
   \   00000034   0700000A           BEQ      ??onLBMessageEditExtList_3
   \   00000038   010050E2           SUBS     R0,R0,#+1
   \   0000003C   0800000A           BEQ      ??onLBMessageEditExtList_4
   \   00000040   010050E2           SUBS     R0,R0,#+1
   \   00000044   0900000A           BEQ      ??onLBMessageEditExtList_5
   \   00000048   010050E2           SUBS     R0,R0,#+1
   \   0000004C   74709F05           LDREQ    R7,??onLBMessageEditExtList_1+0x8  ;; `?<Constant L"\\x62\\x69\\x67\\x20\\x69\\x6d\\x67">`
   \   00000050   456F8502           ADDEQ    R6,R5,#+276
   \   00000054   070000EA           B        ??onLBMessageEditExtList_6
    572              {
    573              case 0:
    574                str=myBook->el_ext;
    575                first_txt=L"extension";
   \                     ??onLBMessageEditExtList_3:
   \   00000058   6C709FE5           LDR      R7,??onLBMessageEditExtList_1+0xC  ;; `?<Constant L"\\x62\\x69\\x67\\x20\\x69\\x6d\\x67">` + 16
   \   0000005C   306085E2           ADD      R6,R5,#+48
   \   00000060   040000EA           B        ??onLBMessageEditExtList_6
    576                break;
    577              case 1:
    578                str=myBook->el_elf;
    579                first_txt=L"elf";
   \                     ??onLBMessageEditExtList_4:
   \   00000064   64709FE5           LDR      R7,??onLBMessageEditExtList_1+0x10  ;; `?<Constant L"\\x62\\x69\\x67\\x20\\x69\\x6d\\x67">` + 36
   \   00000068   546085E2           ADD      R6,R5,#+84
   \   0000006C   010000EA           B        ??onLBMessageEditExtList_6
    580                break;
    581              case 2:
    582                str=myBook->el_smicon;
    583                first_txt=L"small img";
   \                     ??onLBMessageEditExtList_5:
   \   00000070   5C709FE5           LDR      R7,??onLBMessageEditExtList_1+0x14  ;; `?<Constant L"\\x62\\x69\\x67\\x20\\x69\\x6d\\x67">` + 44
   \   00000074   D46085E2           ADD      R6,R5,#+212
    584                break;
    585              case 3:
    586                str=myBook->el_bicon;
    587                first_txt=L"big img";
    588                break;
    589              }
    590              GUIonMessage_SetMenuItemText(msg,TextID_Create(first_txt,ENC_UCS2,TEXTID_ANY_LEN));
   \                     ??onLBMessageEditExtList_6:
   \   00000078   FF50A0E3           MOV      R5,#+255
   \   0000007C   FF5C85E3           ORR      R5,R5,#0xFF00
   \   00000080   0520A0E1           MOV      R2,R5
   \   00000084   0010A0E3           MOV      R1,#+0
   \   00000088   0700A0E1           MOV      R0,R7
   \   0000008C   5D0100EF           SWI      +349
   \   00000090   0010A0E1           MOV      R1,R0
   \   00000094   0400A0E1           MOV      R0,R4
   \   00000098   380100EF           SWI      +312
    591              GUIonMessage_SetMenuItemSecondLineText(msg,TextID_Create(str,ENC_LAT1,TEXTID_ANY_LEN));
   \   0000009C   0520A0E1           MOV      R2,R5
   \   000000A0   0610A0E3           MOV      R1,#+6
   \   000000A4   0600A0E1           MOV      R0,R6
   \   000000A8   5D0100EF           SWI      +349
   \   000000AC   0010A0E1           MOV      R1,R0
   \   000000B0   0400A0E1           MOV      R0,R4
   \   000000B4   390100EF           SWI      +313
    592            }
    593            return(1);
   \                     ??onLBMessageEditExtList_2:
   \   000000B8   0100A0E3           MOV      R0,#+1
   \   000000BC   F080BDE8           POP      {R4-R7,PC}       ;; return
   \                     ??onLBMessageEditExtList_1:
   \   000000C0   00000000           DC8      "",+0,+0,+0
   \   000000C4   00000000           DC8      0x00, 0x00,+0,+0
   \   000000C8   ........           DC32     `?<Constant L"\\x62\\x69\\x67\\x20\\x69\\x6d\\x67">`
   \   000000CC   ........           DC32     `?<Constant L"\\x62\\x69\\x67\\x20\\x69\\x6d\\x67">` + 16
   \   000000D0   ........           DC32     `?<Constant L"\\x62\\x69\\x67\\x20\\x69\\x6d\\x67">` + 36
   \   000000D4   ........           DC32     `?<Constant L"\\x62\\x69\\x67\\x20\\x69\\x6d\\x67">` + 44
    594          };
    595          

   \                                 In segment CODE, align 4, keep-with-next
    596          GUI_LIST *CreateEditExtList(MyBOOK *mbk, int list_id)
    597          {
   \                     ??CreateEditExtList:
   \   00000000   70402DE9           PUSH     {R4-R6,LR}
   \   00000004   40D04DE2           SUB      SP,SP,#+64
   \   00000008   0040A0E1           MOV      R4,R0
   \   0000000C   0150A0E1           MOV      R5,R1
    598            GUI_LIST * lo=CreateListMenu(&mbk->book,0);
   \   00000010   0010A0E3           MOV      R1,#+0
   \   00000014   C00100EF           SWI      +448
   \   00000018   0060A0E1           MOV      R6,R0
    599            wchar_t *title, ustr[32];
    600            mbk->edit_id=list_id;
   \   0000001C   2C5084E5           STR      R5,[R4, #+44]
    601            if (list_id!=-1)
   \   00000020   010075E3           CMN      R5,#+1
   \   00000024   1000000A           BEQ      ??CreateEditExtList_1
    602            {
    603              char *str=(char *)List_Get(mbk->astr,list_id);
   \   00000028   240094E5           LDR      R0,[R4, #+36]
   \   0000002C   0510A0E1           MOV      R1,R5
   \   00000030   AD0100EF           SWI      +429
    604              GetExtInfo(str, mbk->el_ext, mbk->el_elf, mbk->el_smicon, mbk->el_bicon);
   \   00000034   451F84E2           ADD      R1,R4,#+276
   \   00000038   02002DE9           PUSH     {R1}
   \   0000003C   D43084E2           ADD      R3,R4,#+212
   \   00000040   542084E2           ADD      R2,R4,#+84
   \   00000044   301084E2           ADD      R1,R4,#+48
   \   00000048   ........           BL       ??GetExtInfo
    605              snwprintf(ustr,MAXELEMS(ustr)-1,L"Edit ext: %s",mbk->el_ext);
   \   0000004C   C0209FE5           LDR      R2,??CreateEditExtList_2  ;; `?<Constant L"\\x45\\x64\\x69\\x74\\x20\\x65\\x78\\x74\\`
   \   00000050   303084E2           ADD      R3,R4,#+48
   \   00000054   1F10A0E3           MOV      R1,#+31
   \   00000058   04008DE2           ADD      R0,SP,#+4
   \   0000005C   150100EF           SWI      +277
    606              title=ustr;
   \   00000060   04008DE2           ADD      R0,SP,#+4
   \   00000064   04D08DE2           ADD      SP,SP,#+4
   \   00000068   050000EA           B        ??CreateEditExtList_3
    607            }
    608            else
    609            {
    610              title=L"Add new ext";
   \                     ??CreateEditExtList_1:
   \   0000006C   A4009FE5           LDR      R0,??CreateEditExtList_2+0x4  ;; `?<Constant L"\\x45\\x64\\x69\\x74\\x20\\x65\\x78\\x74\\` + 28
    611              *mbk->el_ext=0;
   \   00000070   0010A0E3           MOV      R1,#+0
   \   00000074   3010C4E5           STRB     R1,[R4, #+48]
    612              *mbk->el_elf=0;
   \   00000078   5410C4E5           STRB     R1,[R4, #+84]
    613              *mbk->el_smicon=0;
   \   0000007C   D410C4E5           STRB     R1,[R4, #+212]
    614              *mbk->el_bicon=0;
   \   00000080   1411C4E5           STRB     R1,[R4, #+276]
    615            }
    616            GUIObject_SetTitleText(lo,TextID_Create(title, ENC_UCS2, TEXTID_ANY_LEN));
   \                     ??CreateEditExtList_3:
   \   00000084   FF20A0E3           MOV      R2,#+255
   \   00000088   FF2C82E3           ORR      R2,R2,#0xFF00
   \   0000008C   0010A0E3           MOV      R1,#+0
   \   00000090   5D0100EF           SWI      +349
   \   00000094   0010A0E1           MOV      R1,R0
   \   00000098   0600A0E1           MOV      R0,R6
   \   0000009C   330100EF           SWI      +307
    617            ListMenu_SetItemCount(lo,4);
   \   000000A0   0410A0E3           MOV      R1,#+4
   \   000000A4   0600A0E1           MOV      R0,R6
   \   000000A8   C10100EF           SWI      +449
    618            ListMenu_SetItemStyle(lo,3);
   \   000000AC   0310A0E3           MOV      R1,#+3
   \   000000B0   0600A0E1           MOV      R0,R6
   \   000000B4   3F0100EF           SWI      +319
    619            ListMenu_SetCursorToItem(lo,0);
   \   000000B8   0010A0E3           MOV      R1,#+0
   \   000000BC   0600A0E1           MOV      R0,R6
   \   000000C0   350100EF           SWI      +309
    620            ListMenu_SetOnMessage(lo,onLBMessageEditExtList);
   \   000000C4   50109FE5           LDR      R1,??CreateEditExtList_2+0x8  ;; ??onLBMessageEditExtList
   \   000000C8   0600A0E1           MOV      R0,R6
   \   000000CC   740100EF           SWI      +372
    621            GUIObject_SoftKeys_SetAction(lo,ACTION_BACK,OnBackEditExtList);
   \   000000D0   ........           LDR      R0,??DataTable10  ;; ACTION_BACK
   \   000000D4   44209FE5           LDR      R2,??CreateEditExtList_2+0xC  ;; ??OnBackEditExtList
   \   000000D8   001090E5           LDR      R1,[R0, #+0]
   \   000000DC   0600A0E1           MOV      R0,R6
   \   000000E0   0118A0E1           MOV      R1,R1, LSL #+16
   \   000000E4   2118A0E1           MOV      R1,R1, LSR #+16
   \   000000E8   4B0100EF           SWI      +331
    622            GUIObject_SoftKeys_SetAction(lo,ACTION_SELECT1,OnSelect1EditExtList);
   \   000000EC   ........           LDR      R0,??DataTable11  ;; ACTION_SELECT1
   \   000000F0   2C209FE5           LDR      R2,??CreateEditExtList_2+0x10  ;; ??OnSelect1EditExtList
   \   000000F4   001090E5           LDR      R1,[R0, #+0]
   \   000000F8   0600A0E1           MOV      R0,R6
   \   000000FC   0118A0E1           MOV      R1,R1, LSL #+16
   \   00000100   2118A0E1           MOV      R1,R1, LSR #+16
   \   00000104   4B0100EF           SWI      +331
    623            return (lo);
   \   00000108   0600A0E1           MOV      R0,R6
   \   0000010C   40D08DE2           ADD      SP,SP,#+64
   \   00000110   7080BDE8           POP      {R4-R6,PC}       ;; return
   \                     ??CreateEditExtList_2:
   \   00000114   ........           DC32     `?<Constant L"\\x45\\x64\\x69\\x74\\x20\\x65\\x78\\x74\\`
   \   00000118   ........           DC32     `?<Constant L"\\x45\\x64\\x69\\x74\\x20\\x65\\x78\\x74\\` + 28
   \   0000011C   ........           DC32     ??onLBMessageEditExtList
   \   00000120   ........           DC32     ??OnBackEditExtList
   \   00000124   ........           DC32     ??OnSelect1EditExtList
    624          }
    625          
    626          
    627          // ======================= GuiList ==================================
    628          // устанавливаем тексты в пунктах меню

   \                                 In segment CODE, align 4, keep-with-next
    629          int onLBMessage(GUI_MESSAGE * msg)
    630          {
   \                     ??onLBMessage:
   \   00000000   F0432DE9           PUSH     {R4-R9,LR}
   \   00000004   A4D04DE2           SUB      SP,SP,#+164
   \   00000008   0040A0E1           MOV      R4,R0
    631            MyBOOK * myBook = (MyBOOK *)GUIonMessage_GetBook(msg);
   \   0000000C   750300EF           SWI      +885
   \   00000010   0060A0E1           MOV      R6,R0
    632            int item;
    633            char *str;
    634            switch( GUIonMessage_GetMsg(msg) )
   \   00000014   0400A0E1           MOV      R0,R4
   \   00000018   740300EF           SWI      +884
   \   0000001C   010050E3           CMP      R0,#+1
   \   00000020   3900001A           BNE      ??onLBMessage_1
    635            {
    636              // onCreateListItem
    637            case 1:
    638              item=GUIonMessage_GetCreatedItemIndex(msg);
   \   00000024   0400A0E1           MOV      R0,R4
   \   00000028   370100EF           SWI      +311
   \   0000002C   0070A0E1           MOV      R7,R0
    639              if (item>0)
   \   00000030   010057E3           CMP      R7,#+1
   \   00000034   2C0000BA           BLT      ??onLBMessage_2
    640              {
    641                char el_ext[36];
    642                char el_elf[128];
    643                for (int i=0, icount=1; i<myBook->astr->FirstFree; i++)
   \   00000038   0080A0E3           MOV      R8,#+0
   \   0000003C   0190A0E3           MOV      R9,#+1
   \   00000040   010000EA           B        ??onLBMessage_3
    644                {
    645                
    646                  str=(char *)List_Get(myBook->astr,i);
    647                  if (IsStringValid(str))
    648                  {
    649                    if (icount==item)
    650                      break;
    651                    else 
    652                      icount++;
   \                     ??onLBMessage_4:
   \   00000044   019089E2           ADD      R9,R9,#+1
   \                     ??onLBMessage_5:
   \   00000048   018088E2           ADD      R8,R8,#+1
   \                     ??onLBMessage_3:
   \   0000004C   240096E5           LDR      R0,[R6, #+36]
   \   00000050   B200D0E1           LDRH     R0,[R0, #+2]
   \   00000054   000058E1           CMP      R8,R0
   \   00000058   080000AA           BGE      ??onLBMessage_6
   \   0000005C   240096E5           LDR      R0,[R6, #+36]
   \   00000060   0810A0E1           MOV      R1,R8
   \   00000064   AD0100EF           SWI      +429
   \   00000068   0050A0E1           MOV      R5,R0
   \   0000006C   ........           BL       ??IsStringValid
   \   00000070   000050E3           CMP      R0,#+0
   \   00000074   F3FFFF0A           BEQ      ??onLBMessage_5
   \   00000078   070059E1           CMP      R9,R7
   \   0000007C   F0FFFF1A           BNE      ??onLBMessage_4
    653                  }
    654                }
    655                GetExtInfo(str, el_ext, el_elf, 0, 0);
   \                     ??onLBMessage_6:
   \   00000080   0000A0E3           MOV      R0,#+0
   \   00000084   01002DE9           PUSH     {R0}
   \   00000088   0030A0E3           MOV      R3,#+0
   \   0000008C   04208DE2           ADD      R2,SP,#+4
   \   00000090   84108DE2           ADD      R1,SP,#+132
   \   00000094   0500A0E1           MOV      R0,R5
   \   00000098   ........           BL       ??GetExtInfo
    656                GUIonMessage_SetMenuItemText(msg,TextID_Create(el_ext,ENC_LAT1,TEXTID_ANY_LEN));
   \   0000009C   FF50A0E3           MOV      R5,#+255
   \   000000A0   FF5C85E3           ORR      R5,R5,#0xFF00
   \   000000A4   0520A0E1           MOV      R2,R5
   \   000000A8   0610A0E3           MOV      R1,#+6
   \   000000AC   84008DE2           ADD      R0,SP,#+132
   \   000000B0   5D0100EF           SWI      +349
   \   000000B4   0010A0E1           MOV      R1,R0
   \   000000B8   0400A0E1           MOV      R0,R4
   \   000000BC   380100EF           SWI      +312
    657                GUIonMessage_SetMenuItemSecondLineText(msg,TextID_Create(el_elf,ENC_LAT1,TEXTID_ANY_LEN));
   \   000000C0   0520A0E1           MOV      R2,R5
   \   000000C4   0610A0E3           MOV      R1,#+6
   \   000000C8   04008DE2           ADD      R0,SP,#+4
   \   000000CC   5D0100EF           SWI      +349
   \   000000D0   0010A0E1           MOV      R1,R0
   \   000000D4   0400A0E1           MOV      R0,R4
   \   000000D8   390100EF           SWI      +313
   \   000000DC   04D08DE2           ADD      SP,SP,#+4
   \   000000E0   0100A0E3           MOV      R0,#+1
   \   000000E4   A4D08DE2           ADD      SP,SP,#+164
   \   000000E8   F083BDE8           POP      {R4-R9,PC}
    658              }
    659              else
    660              {
    661                GUIonMessage_SetMenuItemText(msg,TextID_Create(L"add new ext",ENC_UCS2,TEXTID_ANY_LEN));
   \                     ??onLBMessage_2:
   \   000000EC   24009FE5           LDR      R0,??onLBMessage_7  ;; `?<Constant L"\\x61\\x64\\x64\\x20\\x6e\\x65\\x77\\x20\\`
   \   000000F0   FF20A0E3           MOV      R2,#+255
   \   000000F4   FF2C82E3           ORR      R2,R2,#0xFF00
   \   000000F8   0010A0E3           MOV      R1,#+0
   \   000000FC   5D0100EF           SWI      +349
   \   00000100   0010A0E1           MOV      R1,R0
   \   00000104   0400A0E1           MOV      R0,R4
   \   00000108   380100EF           SWI      +312
    662              }
    663            }
    664            return(1);
   \                     ??onLBMessage_1:
   \   0000010C   0100A0E3           MOV      R0,#+1
   \   00000110   A4D08DE2           ADD      SP,SP,#+164
   \   00000114   F083BDE8           POP      {R4-R9,PC}       ;; return
   \                     ??onLBMessage_7:
   \   00000118   ........           DC32     `?<Constant L"\\x61\\x64\\x64\\x20\\x6e\\x65\\x77\\x20\\`
    665          };
    666          

   \                                 In segment CODE, align 4, keep-with-next
    667          void YesNoOnBackGuiList(BOOK * bk, int i)
    668          {
   \                     ??YesNoOnBackGuiList:
   \   00000000   10402DE9           PUSH     {R4,LR}
    669            MyBOOK * mbk=(MyBOOK *)bk;
    670            if (i==1)
   \   00000004   010051E3           CMP      R1,#+1
   \   00000008   0040A0E1           MOV      R4,R0
   \   0000000C   0000001A           BNE      ??YesNoOnBackGuiList_1
    671            {
    672              SaveIni(mbk);
   \   00000010   ........           BL       ??SaveIni
    673            }
    674            FreeBook(&mbk->book);
   \                     ??YesNoOnBackGuiList_1:
   \   00000014   0400A0E1           MOV      R0,R4
   \   00000018   2F0100EF           SWI      +303
    675          }
   \   0000001C   1080BDE8           POP      {R4,PC}          ;; return
    676          
    677          

   \                                 In segment CODE, align 4, keep-with-next
    678          void OnBackGuiList(BOOK * bk, GUI* )
    679          {
   \                     ??OnBackGuiList:
   \   00000000   00402DE9           PUSH     {LR}
    680            MyBOOK * mbk=(MyBOOK *)bk;
    681            if (mbk->is_changed)
   \   00000004   641190E5           LDR      R1,[R0, #+356]
   \   00000008   000051E3           CMP      R1,#+0
   \   0000000C   0300000A           BEQ      ??OnBackGuiList_1
    682              MsgBoxYesNo(mbk, L"Do you want to save ext.ini?",YesNoOnBackGuiList);
   \   00000010   10209FE5           LDR      R2,??OnBackGuiList_2  ;; ??YesNoOnBackGuiList
   \   00000014   10109FE5           LDR      R1,??OnBackGuiList_2+0x4  ;; `?<Constant L"\\x44\\x6f\\x20\\x79\\x6f\\x75\\x20\\x77\\`
   \   00000018   0040BDE8           POP      {LR}             ;; Pop
   \   0000001C   ........           B        ??MsgBoxYesNo    ;; tailcall
    683            else
    684              FreeBook(&mbk->book);
   \                     ??OnBackGuiList_1:
   \   00000020   2F0100EF           SWI      +303
    685          }
   \   00000024   0080BDE8           POP      {PC}             ;; return
   \                     ??OnBackGuiList_2:
   \   00000028   ........           DC32     ??YesNoOnBackGuiList
   \   0000002C   ........           DC32     `?<Constant L"\\x44\\x6f\\x20\\x79\\x6f\\x75\\x20\\x77\\`
    686          

   \                                 In segment CODE, align 4, keep-with-next
    687          void OnSelect1GuiList(BOOK * bk, GUI* )
    688          {
   \                     ??OnSelect1GuiList:
   \   00000000   F0402DE9           PUSH     {R4-R7,LR}
   \   00000004   0040A0E1           MOV      R4,R0
    689            MyBOOK * mbk=(MyBOOK *)bk;
    690            int item=ListMenu_GetSelectedItem((GUI_LIST *)mbk->main_gui);
   \   00000008   180094E5           LDR      R0,[R4, #+24]
   \   0000000C   3E0100EF           SWI      +318
   \   00000010   0050A0E1           MOV      R5,R0
    691            int listitem;
    692            if (item>0)
   \   00000014   010055E3           CMP      R5,#+1
   \   00000018   100000BA           BLT      ??OnSelect1GuiList_1
    693            {
    694              listitem=0;
   \   0000001C   0060A0E3           MOV      R6,#+0
    695              for (int icount=1; listitem<mbk->astr->FirstFree; listitem++)
   \   00000020   0170A0E3           MOV      R7,#+1
   \                     ??OnSelect1GuiList_2:
   \   00000024   240094E5           LDR      R0,[R4, #+36]
   \   00000028   B200D0E1           LDRH     R0,[R0, #+2]
   \   0000002C   000056E1           CMP      R6,R0
   \   00000030   0B0000AA           BGE      ??OnSelect1GuiList_3
    696              {
    697                char *str=(char *)List_Get(mbk->astr,listitem);
   \   00000034   240094E5           LDR      R0,[R4, #+36]
   \   00000038   0610A0E1           MOV      R1,R6
   \   0000003C   AD0100EF           SWI      +429
    698                if (IsStringValid(str))
   \   00000040   ........           BL       ??IsStringValid
   \   00000044   000050E3           CMP      R0,#+0
   \   00000048   0200000A           BEQ      ??OnSelect1GuiList_4
    699                {
    700                  if (icount==item)
   \   0000004C   050057E1           CMP      R7,R5
   \   00000050   0300000A           BEQ      ??OnSelect1GuiList_3
    701                    break;
    702                  else 
    703                    icount++;
   \   00000054   017087E2           ADD      R7,R7,#+1
    704                }
    705              }
   \                     ??OnSelect1GuiList_4:
   \   00000058   016086E2           ADD      R6,R6,#+1
   \   0000005C   F0FFFFEA           B        ??OnSelect1GuiList_2
    706            }
    707            else
    708              listitem=-1;
   \                     ??OnSelect1GuiList_1:
   \   00000060   0060E0E3           MVN      R6,#+0
    709            mbk->edit_list=CreateEditExtList(mbk, listitem);
   \                     ??OnSelect1GuiList_3:
   \   00000064   0610A0E1           MOV      R1,R6
   \   00000068   0400A0E1           MOV      R0,R4
   \   0000006C   ........           BL       ??CreateEditExtList
   \   00000070   280084E5           STR      R0,[R4, #+40]
    710            GUIObject_Show(mbk->edit_list);
   \   00000074   340100EF           SWI      +308
    711          }
   \   00000078   F080BDE8           POP      {R4-R7,PC}       ;; return
    712          

   \                                 In segment CODE, align 4, keep-with-next
    713          void OnDeleteGuiList(BOOK * bk, GUI* )
    714          {
   \                     ??OnDeleteGuiList:
   \   00000000   F0402DE9           PUSH     {R4-R7,LR}
   \   00000004   0040A0E1           MOV      R4,R0
    715            MyBOOK * mbk=(MyBOOK *)bk;
    716            int item=ListMenu_GetSelectedItem((GUI_LIST *)mbk->main_gui);
   \   00000008   180094E5           LDR      R0,[R4, #+24]
   \   0000000C   3E0100EF           SWI      +318
   \   00000010   0050A0E1           MOV      R5,R0
    717            if (item>0)
   \   00000014   010055E3           CMP      R5,#+1
   \   00000018   F080BDB8           POPLT    {R4-R7,PC}
    718            {
    719              int listitem=0;
   \   0000001C   0060A0E3           MOV      R6,#+0
    720              for (int icount=1; listitem<mbk->astr->FirstFree; listitem++)
   \   00000020   0170A0E3           MOV      R7,#+1
   \   00000024   000000EA           B        ??OnDeleteGuiList_1
   \                     ??OnDeleteGuiList_2:
   \   00000028   016086E2           ADD      R6,R6,#+1
   \                     ??OnDeleteGuiList_1:
   \   0000002C   240094E5           LDR      R0,[R4, #+36]
   \   00000030   B200D0E1           LDRH     R0,[R0, #+2]
   \   00000034   000056E1           CMP      R6,R0
   \   00000038   090000AA           BGE      ??OnDeleteGuiList_3
    721              {
    722                char *str=(char *)List_Get(mbk->astr,listitem);
   \   0000003C   240094E5           LDR      R0,[R4, #+36]
   \   00000040   0610A0E1           MOV      R1,R6
   \   00000044   AD0100EF           SWI      +429
    723                if (IsStringValid(str))
   \   00000048   ........           BL       ??IsStringValid
   \   0000004C   000050E3           CMP      R0,#+0
   \   00000050   F4FFFF0A           BEQ      ??OnDeleteGuiList_2
    724                {
    725                  if (icount++==item)
   \   00000054   0700A0E1           MOV      R0,R7
   \   00000058   017080E2           ADD      R7,R0,#+1
   \   0000005C   050050E1           CMP      R0,R5
   \   00000060   F0FFFF1A           BNE      ??OnDeleteGuiList_2
    726                    break;
    727                }
    728              }
    729              char *str=(char *)List_RemoveAt(mbk->astr,listitem);
   \                     ??OnDeleteGuiList_3:
   \   00000064   240094E5           LDR      R0,[R4, #+36]
   \   00000068   0610A0E1           MOV      R1,R6
   \   0000006C   790100EF           SWI      +377
   \   00000070   0010A0E1           MOV      R1,R0
    730              SafeFreeString(mbk, str);
   \   00000074   0400A0E1           MOV      R0,R4
   \   00000078   ........           BL       ??SafeFreeString
    731              mbk->is_changed=1;
   \   0000007C   0100A0E3           MOV      R0,#+1
   \   00000080   640184E5           STR      R0,[R4, #+356]
    732              CreateGuiList(mbk);
   \   00000084   0400A0E1           MOV      R0,R4
   \   00000088   ........           BL       ??CreateGuiList
    733            }
    734          }
   \   0000008C   F080BDE8           POP      {R4-R7,PC}       ;; return
    735          

   \                                 In segment CODE, align 4, keep-with-next
    736          GUI_LIST * CreateGuiList(MyBOOK * mbk)
    737          {
   \                     ??CreateGuiList:
   \   00000000   70402DE9           PUSH     {R4-R6,LR}
   \   00000004   0040A0E1           MOV      R4,R0
    738            int count=1;
    739            FREE_GUI(mbk->main_gui);
   \   00000008   180094E5           LDR      R0,[R4, #+24]
   \   0000000C   0150A0E3           MOV      R5,#+1
   \   00000010   000050E3           CMP      R0,#+0
   \   00000014   0100000A           BEQ      ??CreateGuiList_1
   \   00000018   CE0100EF           SWI      +462
   \   0000001C   180084E5           STR      R0,[R4, #+24]
    740            mbk->main_gui=CreateListMenu(&mbk->book,0);
   \                     ??CreateGuiList_1:
   \   00000020   0010A0E3           MOV      R1,#+0
   \   00000024   0400A0E1           MOV      R0,R4
   \   00000028   C00100EF           SWI      +448
   \   0000002C   180084E5           STR      R0,[R4, #+24]
    741            GUIObject_SetTitleText(mbk->main_gui,TextID_Create(L"ExtEditor", ENC_UCS2, TEXTID_ANY_LEN));
   \   00000030   04019FE5           LDR      R0,??CreateGuiList_2  ;; `?<Constant L"\\x45\\x78\\x74\\x45\\x64\\x69\\x74\\x6f\\`
   \   00000034   FF20A0E3           MOV      R2,#+255
   \   00000038   FF2C82E3           ORR      R2,R2,#0xFF00
   \   0000003C   0010A0E3           MOV      R1,#+0
   \   00000040   5D0100EF           SWI      +349
   \   00000044   0010A0E1           MOV      R1,R0
   \   00000048   180094E5           LDR      R0,[R4, #+24]
    742            
    743            for (int i=0; i<mbk->astr->FirstFree; i++)
   \   0000004C   0060A0E3           MOV      R6,#+0
   \   00000050   330100EF           SWI      +307
   \   00000054   240094E5           LDR      R0,[R4, #+36]
   \   00000058   B200D0E1           LDRH     R0,[R0, #+2]
   \   0000005C   000050E3           CMP      R0,#+0
   \   00000060   0700001A           BNE      ??CreateGuiList_3
   \   00000064   0A0000EA           B        ??CreateGuiList_4
    744            {
    745              char *str=(char *)List_Get(mbk->astr, i);
   \                     ??CreateGuiList_5:
   \   00000068   240094E5           LDR      R0,[R4, #+36]
   \   0000006C   0610A0E1           MOV      R1,R6
   \   00000070   AD0100EF           SWI      +429
    746              if (IsStringValid(str))
   \   00000074   ........           BL       ??IsStringValid
   \   00000078   000050E3           CMP      R0,#+0
    747              {
    748                count++;
   \   0000007C   01508512           ADDNE    R5,R5,#+1
    749              }
    750            }
   \   00000080   016086E2           ADD      R6,R6,#+1
   \                     ??CreateGuiList_3:
   \   00000084   240094E5           LDR      R0,[R4, #+36]
   \   00000088   B200D0E1           LDRH     R0,[R0, #+2]
   \   0000008C   000056E1           CMP      R6,R0
   \   00000090   F4FFFFBA           BLT      ??CreateGuiList_5
    751            ListMenu_SetItemCount(mbk->main_gui,count);
   \                     ??CreateGuiList_4:
   \   00000094   180094E5           LDR      R0,[R4, #+24]
   \   00000098   0510A0E1           MOV      R1,R5
   \   0000009C   C10100EF           SWI      +449
    752            ListMenu_SetOnMessage(mbk->main_gui,onLBMessage);
   \   000000A0   98109FE5           LDR      R1,??CreateGuiList_2+0x4  ;; ??onLBMessage
   \   000000A4   180094E5           LDR      R0,[R4, #+24]
   \   000000A8   740100EF           SWI      +372
    753            ListMenu_SetItemStyle(mbk->main_gui,3);
   \   000000AC   180094E5           LDR      R0,[R4, #+24]
   \   000000B0   0310A0E3           MOV      R1,#+3
   \   000000B4   3F0100EF           SWI      +319
    754            ListMenu_SetCursorToItem(mbk->main_gui,0);
   \   000000B8   180094E5           LDR      R0,[R4, #+24]
   \   000000BC   0010A0E3           MOV      R1,#+0
   \   000000C0   350100EF           SWI      +309
    755            GUIObject_SoftKeys_SetAction(mbk->main_gui,ACTION_BACK, OnBackGuiList);
   \   000000C4   ........           LDR      R0,??DataTable10  ;; ACTION_BACK
   \   000000C8   74209FE5           LDR      R2,??CreateGuiList_2+0x8  ;; ??OnBackGuiList
   \   000000CC   001090E5           LDR      R1,[R0, #+0]
   \   000000D0   180094E5           LDR      R0,[R4, #+24]
   \   000000D4   0118A0E1           MOV      R1,R1, LSL #+16
   \   000000D8   2118A0E1           MOV      R1,R1, LSR #+16
   \   000000DC   4B0100EF           SWI      +331
    756            GUIObject_SoftKeys_SetAction(mbk->main_gui,ACTION_SELECT1,OnSelect1GuiList);
   \   000000E0   ........           LDR      R0,??DataTable11  ;; ACTION_SELECT1
   \   000000E4   5C209FE5           LDR      R2,??CreateGuiList_2+0xC  ;; ??OnSelect1GuiList
   \   000000E8   001090E5           LDR      R1,[R0, #+0]
   \   000000EC   180094E5           LDR      R0,[R4, #+24]
   \   000000F0   0118A0E1           MOV      R1,R1, LSL #+16
   \   000000F4   2118A0E1           MOV      R1,R1, LSR #+16
   \   000000F8   4B0100EF           SWI      +331
    757            GUIObject_SoftKeys_SetAction(mbk->main_gui,ACTION_DELETE,OnDeleteGuiList);
   \   000000FC   48009FE5           LDR      R0,??CreateGuiList_2+0x10  ;; ACTION_DELETE
   \   00000100   48209FE5           LDR      R2,??CreateGuiList_2+0x14  ;; ??OnDeleteGuiList
   \   00000104   005090E5           LDR      R5,[R0, #+0]
   \   00000108   180094E5           LDR      R0,[R4, #+24]
   \   0000010C   0518A0E1           MOV      R1,R5, LSL #+16
   \   00000110   2118A0E1           MOV      R1,R1, LSR #+16
   \   00000114   4B0100EF           SWI      +331
    758            GUIObject_SoftKeys_SetVisible(mbk->main_gui,ACTION_DELETE,0);
   \   00000118   180094E5           LDR      R0,[R4, #+24]
   \   0000011C   0020A0E3           MOV      R2,#+0
   \   00000120   0518A0E1           MOV      R1,R5, LSL #+16
   \   00000124   2118A0E1           MOV      R1,R1, LSR #+16
   \   00000128   500100EF           SWI      +336
    759            GUIObject_Show(mbk->main_gui);
   \   0000012C   180094E5           LDR      R0,[R4, #+24]
   \   00000130   340100EF           SWI      +308
    760            return(mbk->main_gui);
   \   00000134   180094E5           LDR      R0,[R4, #+24]
   \   00000138   7080BDE8           POP      {R4-R6,PC}       ;; return
   \                     ??CreateGuiList_2:
   \   0000013C   ........           DC32     `?<Constant L"\\x45\\x78\\x74\\x45\\x64\\x69\\x74\\x6f\\`
   \   00000140   ........           DC32     ??onLBMessage
   \   00000144   ........           DC32     ??OnBackGuiList
   \   00000148   ........           DC32     ??OnSelect1GuiList
   \   0000014C   ........           DC32     ACTION_DELETE
   \   00000150   ........           DC32     ??OnDeleteGuiList
    761          };
    762          
    763          // ==================================================================
    764          

   \                                 In segment CODE, align 4, keep-with-next
    765          GUI *CreateEditGui(MyBOOK *bk)
    766          {
   \                     ??CreateEditGui:
   \   00000000   10402DE9           PUSH     {R4,LR}
   \   00000004   0040A0E1           MOV      R4,R0
    767            GUI *gui=NULL;
    768            ReadIni(bk);
   \   00000008   ........           BL       ??ReadIni
    769            gui = CreateGuiList(bk);  
    770            return (gui);
   \   0000000C   0400A0E1           MOV      R0,R4
   \   00000010   1040BDE8           POP      {R4,LR}          ;; Pop
   \   00000014   ........           B        ??CreateGuiList  ;; tailcall
    771          }
    772          
    773          

   \                                 In segment CODE, align 4, keep-with-next
    774          static int MainPageOnEnter(void *, BOOK *bk)
    775          {
   \                     ??MainPageOnEnter:
   \   00000000   10402DE9           PUSH     {R4,LR}
   \   00000004   0140A0E1           MOV      R4,R1
    776            MyBOOK *mbk=(MyBOOK *)bk;
    777            mbk->astr=List_Create();
   \   00000008   690100EF           SWI      +361
   \   0000000C   240084E5           STR      R0,[R4, #+36]
    778            CreateEditGui(mbk);
   \   00000010   0400A0E1           MOV      R0,R4
   \   00000014   ........           BL       ??CreateEditGui
    779            return (1);
   \   00000018   0100A0E3           MOV      R0,#+1
   \   0000001C   1080BDE8           POP      {R4,PC}          ;; return
    780          }
    781          

   \                                 In segment CODE, align 4, keep-with-next
    782          static int MainPageOnExit(void *, BOOK *bk)
    783          {
   \                     ??MainPageOnExit:
   \   00000000   10402DE9           PUSH     {R4,LR}
   \   00000004   0140A0E1           MOV      R4,R1
    784            MyBOOK *mbk=(MyBOOK *)bk;
    785            FREE_GUI(mbk->si_editext);
   \   00000008   580194E5           LDR      R0,[R4, #+344]
   \   0000000C   000050E3           CMP      R0,#+0
   \   00000010   0100000A           BEQ      ??MainPageOnExit_1
   \   00000014   CE0100EF           SWI      +462
   \   00000018   580184E5           STR      R0,[R4, #+344]
    786            FREE_GUI(mbk->edit_list);
   \                     ??MainPageOnExit_1:
   \   0000001C   280094E5           LDR      R0,[R4, #+40]
   \   00000020   000050E3           CMP      R0,#+0
   \   00000024   0100000A           BEQ      ??MainPageOnExit_2
   \   00000028   CE0100EF           SWI      +462
   \   0000002C   280084E5           STR      R0,[R4, #+40]
    787            FREE_GUI(mbk->main_gui);
   \                     ??MainPageOnExit_2:
   \   00000030   180094E5           LDR      R0,[R4, #+24]
   \   00000034   000050E3           CMP      R0,#+0
   \   00000038   0100000A           BEQ      ??MainPageOnExit_3
   \   0000003C   CE0100EF           SWI      +462
   \   00000040   180084E5           STR      R0,[R4, #+24]
    788            FREE_GUI(mbk->yes_no);
   \                     ??MainPageOnExit_3:
   \   00000044   5C0194E5           LDR      R0,[R4, #+348]
   \   00000048   000050E3           CMP      R0,#+0
   \   0000004C   0100000A           BEQ      ??MainPageOnExit_4
   \   00000050   CE0100EF           SWI      +462
   \   00000054   5C0184E5           STR      R0,[R4, #+348]
    789            DestroyStringList(mbk);
   \                     ??MainPageOnExit_4:
   \   00000058   0400A0E1           MOV      R0,R4
   \   0000005C   ........           BL       ??DestroyStringList
    790            List_Destroy(mbk->astr);
   \   00000060   240094E5           LDR      R0,[R4, #+36]
   \   00000064   6A0100EF           SWI      +362
    791            delete mbk->ebuf;
   \   00000068   1C0094E5           LDR      R0,[R4, #+28]
   \   0000006C   ........           _BLF     `??operator delete`,`??operator delete??rA`
    792            mbk->ebuf=NULL;
   \   00000070   0000A0E3           MOV      R0,#+0
   \   00000074   1C0084E5           STR      R0,[R4, #+28]
    793            mbk->ebuf_len=0;
   \   00000078   200084E5           STR      R0,[R4, #+32]
    794            return (1);
   \   0000007C   0100A0E3           MOV      R0,#+1
   \   00000080   1080BDE8           POP      {R4,PC}          ;; return
    795          }
    796          

   \                                 In segment DYN_PAGE, align 4, align-sorted
    797          const PAGE_MSG bk_msglst_main[] @ "DYN_PAGE"  = 
   \                     bk_msglst_main:
   \   00000000   42000000....       DC32 66, ??MainPageOnEnter, 67, ??MainPageOnExit, 64, 0H
   \              ....43000000
   \              ........4000
   \              000000000000

   \                                 In segment DATA_C, align 4, align-sorted
   \                     `?<Constant "ExtEditor">`:
   \   00000000   457874456469       DC8 "ExtEditor"
   \              746F7200    
   \   0000000A   0000               DC8 0, 0
   \   0000000C   ........0000       DC32 `?<Constant "ExtEditor_Base_Page">`, 0H, bk_msglst_base
   \              0000........
   \   00000018   ........0000       DC32 `?<Constant "ExtEditor_Main_Page">`, 0H, bk_msglst_main
   \              0000........

   \                                 In segment DATA_C, align 4, align-sorted
   \                     bk_selbcfg:
   \   00000000   ........0000       DC32 `?<Constant "ExtEditor_SelectFile_...">`, 0H, bk_msglst_selfile
   \              0000........
    798          {
    799            PAGE_ENTER_EVENT_TAG,    MainPageOnEnter,
    800            PAGE_EXIT_EVENT_TAG,     MainPageOnExit,
    801            NIL_EVENT_TAG,           NULL
    802          };
    803          
    804          const PAGE_DESC bk_main = {"ExtEditor_Main_Page",0,bk_msglst_main};
    805          
    806          
    807          // при закрытии книги

   \                                 In segment CODE, align 4, keep-with-next
    808          static void onMyBookClose(BOOK * book)
    809          {
    810            SUBPROC(elf_exit);
   \                     ??onMyBookClose:
   \   00000000   ........           LDR      R0,??DataTable15  ;; ??elf_exit
   \   00000004   00402DE9           PUSH     {LR}
   \   00000008   080100EF           SWI      +264
    811          }
   \   0000000C   0080BDE8           POP      {PC}             ;; return
    812          

   \                                 In segment CODE, align 4, keep-with-next
    813          int isExtEditorBook(BOOK * struc)
    814          {
    815            return(struc->onClose == onMyBookClose);
   \                     ??isExtEditorBook:
   \   00000000   040090E5           LDR      R0,[R0, #+4]
   \   00000004   ........           LDR      R1,??DataTable14  ;; ??onMyBookClose
   \   00000008   010050E1           CMP      R0,R1
   \   0000000C   0100A003           MOVEQ    R0,#+1
   \   00000010   1EFF2F01           BXEQ     LR
   \   00000014   0000A0E3           MOV      R0,#+0
   \   00000018   1EFF2FE1           BX       LR               ;; return
    816          }
    817          

   \                                 In segment CODE, align 4, keep-with-next
    818          int main(wchar_t *elfname, wchar_t *path, wchar_t *fname)
    819          {
   \                     main:
   \   00000000   10402DE9           PUSH     {R4,LR}
    820            MyBOOK *mbk=new MyBOOK;
   \   00000004   5A0FA0E3           MOV      R0,#+360
   \   00000008   ........           _BLF     `??operator new`,`??operator new??rA`
   \   0000000C   0040A0E1           MOV      R4,R0
    821            memset(mbk,0,sizeof(MyBOOK));
   \   00000010   5A2FA0E3           MOV      R2,#+360
   \   00000014   0010A0E3           MOV      R1,#+0
   \   00000018   120100EF           SWI      +274
    822            if (!CreateBook((BOOK*)mbk,onMyBookClose,&bk_base,"ExtEditor",-1,0))
   \   0000001C   58009FE5           LDR      R0,??main_0      ;; `?<Constant "ExtEditor">`
   \   00000020   0010A0E3           MOV      R1,#+0
   \   00000024   02002DE9           PUSH     {R1}
   \   00000028   0030A0E1           MOV      R3,R0
   \   0000002C   0C2080E2           ADD      R2,R0,#+12
   \   00000030   0400A0E1           MOV      R0,R4
   \   00000034   0110E0E1           MVN      R1,R1
   \   00000038   02002DE9           PUSH     {R1}
   \   0000003C   ........           LDR      R1,??DataTable14  ;; ??onMyBookClose
   \   00000040   2B0100EF           SWI      +299
   \   00000044   000050E3           CMP      R0,#+0
   \   00000048   08D08DE2           ADD      SP,SP,#+8
   \   0000004C   0500001A           BNE      ??main_1
    823            {
    824              delete mbk;
   \   00000050   0400A0E1           MOV      R0,R4
   \   00000054   ........           _BLF     `??operator delete`,`??operator delete??rA`
    825              SUBPROC(elf_exit);
   \   00000058   ........           LDR      R0,??DataTable15  ;; ??elf_exit
   \   0000005C   080100EF           SWI      +264
    826              return (0);    
   \   00000060   0000A0E3           MOV      R0,#+0
   \   00000064   1080BDE8           POP      {R4,PC}
    827            }
    828            BookObj_GotoPage(&mbk->book,&bk_main);
   \                     ??main_1:
   \   00000068   10109FE5           LDR      R1,??main_0+0x4  ;; `?<Constant "ExtEditor">` + 24
   \   0000006C   0400A0E1           MOV      R0,R4
   \   00000070   2D0100EF           SWI      +301
    829            return 0;
   \   00000074   0000A0E3           MOV      R0,#+0
   \   00000078   1080BDE8           POP      {R4,PC}          ;; return
   \                     ??main_0:
   \   0000007C   ........           DC32     `?<Constant "ExtEditor">`
   \   00000080   ........           DC32     `?<Constant "ExtEditor">` + 24
    830          }

   \                                 In segment CODE, align 4, keep-with-next
   \                     ??DataTable1:
   \   00000000   ........           DC32     `?<Constant L"\\x2f\\x45\\x78\\x74\\x65\\x6e\\x73\\x69\\_1`

   \                                 In segment CODE, align 4, keep-with-next
   \                     ??DataTable3:
   \   00000000   ........           DC32     PREVIOUS_EVENT

   \                                 In segment CODE, align 4, keep-with-next
   \                     ??DataTable6:
   \   00000000   ........           DC32     VAR_ARG_CALL_BACK_PREV_ACT

   \                                 In segment CODE, align 4, keep-with-next
   \                     ??DataTable7:
   \   00000000   ........           DC32     VAR_ARG_BOOK

   \                                 In segment CODE, align 4, keep-with-next
   \                     ??DataTable10:
   \   00000000   ........           DC32     ACTION_BACK

   \                                 In segment CODE, align 4, keep-with-next
   \                     ??DataTable11:
   \   00000000   ........           DC32     ACTION_SELECT1

   \                                 In segment CODE, align 4, keep-with-next
   \                     ??DataTable14:
   \   00000000   ........           DC32     ??onMyBookClose

   \                                 In segment CODE, align 4, keep-with-next
   \                     ??DataTable15:
   \   00000000   ........           DC32     ??elf_exit

   \                                 In segment ELFBEGIN, align 1

   \                                 In segment DATA_C, align 4, align-sorted
   \                     `?<Constant L"\\x2a\\x2e\\x70\\x6e\\x67\\x3b\\x2a\\x2e\\`:
   \   00000000   2A002E007000       DC8 2AH, 0, 2EH, 0, 70H, 0, 6EH, 0
   \              6E00        
   \   00000008   67003B002A00       DC8 67H, 0, 3BH, 0, 2AH, 0, 2EH, 0
   \              2E00        
   \   00000010   670069006600       DC8 67H, 0, 69H, 0, 66H, 0, 3BH, 0
   \              3B00        
   \   00000018   2A002E006A00       DC8 2AH, 0, 2EH, 0, 6AH, 0, 70H, 0
   \              7000        
   \   00000020   67003B002A00       DC8 67H, 0, 3BH, 0, 2AH, 0, 2EH, 0
   \              2E00        
   \   00000028   6A0070006500       DC8 6AH, 0, 70H, 0, 65H, 0, 67H, 0
   \              6700        
   \   00000030   0000               DC8 0, 0
   \   00000032   0000               DC8 0, 0
   \   00000034   25006C007300       DC8 25H, 0, 6CH, 0, 73H, 0, 25H, 0
   \              2500        
   \   0000003C   73000000           DC8 73H, 0, 0, 0
   \   00000040   2A002E006500       DC8 2AH, 0, 2EH, 0, 65H, 0, 6CH, 0
   \              6C00        
   \   00000048   66000000           DC8 66H, 0, 0, 0
   \   0000004C   2F0045007800       DC8 2FH, 0, 45H, 0, 78H, 0, 74H, 0
   \              7400        
   \   00000054   65006E007300       DC8 65H, 0, 6EH, 0, 73H, 0, 69H, 0
   \              6900        
   \   0000005C   6F006E000000       DC8 6FH, 0, 6EH, 0, 0, 0
   \   00000062   0000               DC8 0, 0
   \   00000064   530065006C00       DC8 53H, 0, 65H, 0, 6CH, 0, 65H, 0
   \              6500        
   \   0000006C   630074004600       DC8 63H, 0, 74H, 0, 46H, 0, 69H, 0
   \              6900        
   \   00000074   6C0065000000       DC8 6CH, 0, 65H, 0, 0, 0
   \   0000007A   0000               DC8 0, 0

   \                                 In segment DATA_C, align 4, align-sorted
   \                     `?<Constant L"\\x62\\x69\\x67\\x20\\x69\\x6d\\x67">`:
   \   00000000   620069006700       DC8 62H, 0, 69H, 0, 67H, 0, 20H, 0
   \              2000        
   \   00000008   69006D006700       DC8 69H, 0, 6DH, 0, 67H, 0, 0, 0
   \              0000        
   \   00000010   650078007400       DC8 65H, 0, 78H, 0, 74H, 0, 65H, 0
   \              6500        
   \   00000018   6E0073006900       DC8 6EH, 0, 73H, 0, 69H, 0, 6FH, 0
   \              6F00        
   \   00000020   6E000000           DC8 6EH, 0, 0, 0
   \   00000024   65006C006600       DC8 65H, 0, 6CH, 0, 66H, 0, 0, 0
   \              0000        
   \   0000002C   73006D006100       DC8 73H, 0, 6DH, 0, 61H, 0, 6CH, 0
   \              6C00        
   \   00000034   6C0020006900       DC8 6CH, 0, 20H, 0, 69H, 0, 6DH, 0
   \              6D00        
   \   0000003C   67000000           DC8 67H, 0, 0, 0

   \                                 In segment DATA_C, align 4, align-sorted
   \                     `?<Constant L"\\x45\\x64\\x69\\x74\\x20\\x65\\x78\\x74\\`:
   \   00000000   450064006900       DC8 45H, 0, 64H, 0, 69H, 0, 74H, 0
   \              7400        
   \   00000008   200065007800       DC8 20H, 0, 65H, 0, 78H, 0, 74H, 0
   \              7400        
   \   00000010   3A0020002500       DC8 3AH, 0, 20H, 0, 25H, 0, 73H, 0
   \              7300        
   \   00000018   0000               DC8 0, 0
   \   0000001A   0000               DC8 0, 0
   \   0000001C   410064006400       DC8 41H, 0, 64H, 0, 64H, 0, 20H, 0
   \              2000        
   \   00000024   6E0065007700       DC8 6EH, 0, 65H, 0, 77H, 0, 20H, 0
   \              2000        
   \   0000002C   650078007400       DC8 65H, 0, 78H, 0, 74H, 0, 0, 0
   \              0000        

   \                                 In segment DATA_C, align 4, align-sorted
   \                     `?<Constant L"\\x61\\x64\\x64\\x20\\x6e\\x65\\x77\\x20\\`:
   \   00000000   610064006400       DC8 61H, 0, 64H, 0, 64H, 0, 20H, 0
   \              2000        
   \   00000008   6E0065007700       DC8 6EH, 0, 65H, 0, 77H, 0, 20H, 0
   \              2000        
   \   00000010   650078007400       DC8 65H, 0, 78H, 0, 74H, 0, 0, 0
   \              0000        

   \                                 In segment DATA_C, align 4, align-sorted
   \                     `?<Constant L"\\x44\\x6f\\x20\\x79\\x6f\\x75\\x20\\x77\\`:
   \   00000000   44006F002000       DC8 44H, 0, 6FH, 0, 20H, 0, 79H, 0
   \              7900        
   \   00000008   6F0075002000       DC8 6FH, 0, 75H, 0, 20H, 0, 77H, 0
   \              7700        
   \   00000010   61006E007400       DC8 61H, 0, 6EH, 0, 74H, 0, 20H, 0
   \              2000        
   \   00000018   74006F002000       DC8 74H, 0, 6FH, 0, 20H, 0, 73H, 0
   \              7300        
   \   00000020   610076006500       DC8 61H, 0, 76H, 0, 65H, 0, 20H, 0
   \              2000        
   \   00000028   650078007400       DC8 65H, 0, 78H, 0, 74H, 0, 2EH, 0
   \              2E00        
   \   00000030   69006E006900       DC8 69H, 0, 6EH, 0, 69H, 0, 3FH, 0
   \              3F00        
   \   00000038   0000               DC8 0, 0
   \   0000003A   0000               DC8 0, 0

   \                                 In segment DATA_C, align 4, align-sorted
   \                     `?<Constant "ExtEditor_Base_Page">`:
   \   00000000   457874456469       DC8 "ExtEditor_Base_Page"
   \              746F725F4261
   \              73655F506167
   \              6500        

   \                                 In segment DATA_C, align 4, align-sorted
   \                     `?<Constant "ExtEditor_SelectFile_...">`:
   \   00000000   457874456469       DC8 "ExtEditor_SelectFile_Page"
   \              746F725F5365
   \              6C6563744669
   \              6C655F506167
   \              6500        
   \   0000001A   0000               DC8 0, 0

   \                                 In segment DATA_C, align 4, align-sorted
   \                     `?<Constant "ExtEditor_Main_Page">`:
   \   00000000   457874456469       DC8 "ExtEditor_Main_Page"
   \              746F725F4D61
   \              696E5F506167
   \              6500        

   \                                 In segment DATA_C, align 4, align-sorted
   \                     `?<Constant L"\\xa\\x45\\x78\\x74\\x45\\x64\\x69\\x74\\x`:
   \   00000000   0A0045007800       DC8 0AH, 0, 45H, 0, 78H, 0, 74H, 0
   \              7400        
   \   00000008   450064006900       DC8 45H, 0, 64H, 0, 69H, 0, 74H, 0
   \              7400        
   \   00000010   6F0072002000       DC8 6FH, 0, 72H, 0, 20H, 0, 76H, 0
   \              7600        
   \   00000018   31002E003000       DC8 31H, 0, 2EH, 0, 30H, 0, 0AH, 0
   \              0A00        
   \   00000020   520065007600       DC8 52H, 0, 65H, 0, 76H, 0, 69H, 0
   \              6900        
   \   00000028   730069006F00       DC8 73H, 0, 69H, 0, 6FH, 0, 6EH, 0
   \              6E00        
   \   00000030   200025006400       DC8 20H, 0, 25H, 0, 64H, 0, 0AH, 0
   \              0A00        
   \   00000038   280063002900       DC8 28H, 0, 63H, 0, 29H, 0, 20H, 0
   \              2000        
   \   00000040   4B0072006500       DC8 4BH, 0, 72H, 0, 65H, 0, 4EH, 0
   \              4E00        
   \   00000048   0000               DC8 0, 0
   \   0000004A   0000               DC8 0, 0

   \                                 In segment DATA_C, align 4, align-sorted
   \                     `?<Constant L"\\x2f\\x45\\x78\\x74\\x65\\x6e\\x73\\x69\\_1`:
   \   00000000   2F0045007800       DC8 2FH, 0, 45H, 0, 78H, 0, 74H, 0
   \              7400        
   \   00000008   65006E007300       DC8 65H, 0, 6EH, 0, 73H, 0, 69H, 0
   \              6900        
   \   00000010   6F006E002F00       DC8 6FH, 0, 6EH, 0, 2FH, 0, 65H, 0
   \              6500        
   \   00000018   780074002E00       DC8 78H, 0, 74H, 0, 2EH, 0, 69H, 0
   \              6900        
   \   00000020   6E0069000000       DC8 6EH, 0, 69H, 0, 0, 0
   \   00000026   0000               DC8 0, 0

   \                                 In segment DATA_C, align 1, align-sorted
   \   00000000   0D0A00             DC8 "\015\012"

   \                                 In segment DATA_C, align 4, align-sorted
   \                     `?<Constant L"\\x45\\x78\\x74\\x45\\x64\\x69\\x74\\x6f\\`:
   \   00000000   450078007400       DC8 45H, 0, 78H, 0, 74H, 0, 45H, 0
   \              4500        
   \   00000008   640069007400       DC8 64H, 0, 69H, 0, 74H, 0, 6FH, 0
   \              6F00        
   \   00000010   72000000           DC8 72H, 0, 0, 0

   \                                 In segment DATA_C, align 4, align-sorted
   \                     `?<Constant L"\\x49\\x6e\\x70\\x75\\x74\\x20\\x6e\\x65\\`:
   \   00000000   49006E007000       DC8 49H, 0, 6EH, 0, 70H, 0, 75H, 0
   \              7500        
   \   00000008   740020006E00       DC8 74H, 0, 20H, 0, 6EH, 0, 65H, 0
   \              6500        
   \   00000010   770020006500       DC8 77H, 0, 20H, 0, 65H, 0, 78H, 0
   \              7800        
   \   00000018   74000000           DC8 74H, 0, 0, 0

   \                                 In segment DATA_C, align 4, align-sorted
   \                     `?<Constant "[EXT99]: %s, %s, %s, %s">`:
   \   00000000   5B4558543939       DC8 "[EXT99]: %s, %s, %s, %s"
   \              5D3A2025732C
   \              2025732C2025
   \              732C20257300

   \                                 In segment DATA_C, align 4, align-sorted
   \                     `?<Constant L"\\x44\\x6f\\x20\\x79\\x6f\\x75\\x20\\x77\\_1`:
   \   00000000   44006F002000       DC8 44H, 0, 6FH, 0, 20H, 0, 79H, 0
   \              7900        
   \   00000008   6F0075002000       DC8 6FH, 0, 75H, 0, 20H, 0, 77H, 0
   \              7700        
   \   00000010   61006E007400       DC8 61H, 0, 6EH, 0, 74H, 0, 20H, 0
   \              2000        
   \   00000018   74006F002000       DC8 74H, 0, 6FH, 0, 20H, 0, 73H, 0
   \              7300        
   \   00000020   610076006500       DC8 61H, 0, 76H, 0, 65H, 0, 20H, 0
   \              2000        
   \   00000028   630068006100       DC8 63H, 0, 68H, 0, 61H, 0, 6EH, 0
   \              6E00        
   \   00000030   670065007300       DC8 67H, 0, 65H, 0, 73H, 0, 3FH, 0
   \              3F00        
   \   00000038   0000               DC8 0, 0
   \   0000003A   0000               DC8 0, 0

   \                                 In segment DATA_C, align 1, align-sorted
   \   00000000   00                 DC8 ""

   \                                 In segment DATA_C, align 2, align-sorted
   \   00000000   0000               DC8 0, 0

   Maximum stack usage in bytes:

     Function                       CSTACK
     --------                       ------
     CreateEditExtList(MyBOOK *, int)
                                       84
     CreateEditGui(MyBOOK *)            8
     CreateGuiList(MyBOOK *)           16
     CreateSI_EditExt(MyBOOK *)       200
     DestroyStringList(MyBOOK *)        8
     GetExtInfo(char *, char *, char *, char *, char *)
                                       32
     IsStringValid(char *)              8
     MainPageOnEnter(void *, BOOK *)
                                        8
     MainPageOnExit(void *, BOOK *)     8
     MsgBoxYesNo(MyBOOK *, wchar_t *, void (*)(BOOK *, int))
                                       44
     OnBackEditExtList(BOOK *, GUI *)
                                      304
     OnBackGuiList(BOOK *, GUI *)       4
     OnBackSI_EditExt(BOOK *, u16 *, int)
                                        8
     OnDeleteGuiList(BOOK *, GUI *)    20
     OnOkSI_EditExt(BOOK *, wchar_t *, int)
                                        8
     OnSelect1EditExtList(BOOK *, GUI *)
                                        8
     OnSelect1GuiList(BOOK *, GUI *)
                                       20
     ReadIni(MyBOOK *)                272
     SafeFreeString(MyBOOK *, char *)
                                        4
     SaveIni(MyBOOK *)                284
     SelFileFilterElf(wchar_t const *, wchar_t const *, wchar_t const *)
                                       40
     SelFilePageOnAccept(void *, BOOK *)
                                       24
     SelFilePageOnCancel(void *, BOOK *)
                                        4
     SelFilePageOnCreate(void *, BOOK *)
                                      720
     ShowAuthorInfo(void *, BOOK *)   144
     TerminateElf(void *, BOOK *)       4
     YSNo(BOOK *, void *)               8
     YSPrev(BOOK *, void *)             8
     YSYes(BOOK *, void *)              8
     YesNoOnBackExt(BOOK *, int)      276
     YesNoOnBackGuiList(BOOK *, int)
                                        8
     elf_exit()                         4
     find_eol(char *, int *)            0
     isExtEditorBook(BOOK *)            0
     main(wchar_t *, wchar_t *, wchar_t *)
                                       16
     onLBMessage(GUI_MESSAGE *)       196
     onLBMessageEditExtList(GUI_MESSAGE *)
                                       20
     onMyBookClose(BOOK *)              4
     strchr(char *, int)                0
     strcmp_nocase(char const *, char const *)
                                        0
     unicode2win1251(char *, wchar_t *, int)
                                        4
     win12512unicode(wchar_t *, char const *, int)
                                        0


   Segment part sizes:

     Function/Label                 Bytes
     --------------                 -----
     elf_exit()                       28
     win12512unicode(wchar_t *, char const *, int)
                                     152
     unicode2win1251(char *, wchar_t *, int)
                                     192
     strcmp_nocase(char const *, char const *)
                                      48
     TerminateElf(void *, BOOK *)     20
     ShowAuthorInfo(void *, BOOK *)  112
     bk_msglst_base                   24
     SafeFreeString(MyBOOK *, char *)
                                      52
     DestroyStringList(MyBOOK *)      68
     find_eol(char *, int *)          96
     strchr(char *, int)              44
     GetExtInfo(char *, char *, char *, char *, char *)
                                     624
     IsStringValid(char *)            48
     SaveIni(MyBOOK *)               340
     ReadIni(MyBOOK *)               276
     SelFileFilterElf(wchar_t const *, wchar_t const *, wchar_t const *)
                                      80
     SelFilePageOnCreate(void *, BOOK *)
                                     580
     folderpics                      256
     SelFilePageOnAccept(void *, BOOK *)
                                     372
     SelFilePageOnCancel(void *, BOOK *)
                                      28
     bk_msglst_selfile                40
     OnBackSI_EditExt(BOOK *, u16 *, int)
                                      32
     OnOkSI_EditExt(BOOK *, wchar_t *, int)
                                      44
     CreateSI_EditExt(MyBOOK *)      248
     YSYes(BOOK *, void *)            44
     YSNo(BOOK *, void *)             44
     YSPrev(BOOK *, void *)           32
     MsgBoxYesNo(MyBOOK *, wchar_t *, void (*)(BOOK *, int))
                                     152
     OnSelect1EditExtList(BOOK *, GUI *)
                                      76
     YesNoOnBackExt(BOOK *, int)     196
     OnBackEditExtList(BOOK *, GUI *)
                                     236
     onLBMessageEditExtList(GUI_MESSAGE *)
                                     216
     CreateEditExtList(MyBOOK *, int)
                                     296
     onLBMessage(GUI_MESSAGE *)      284
     YesNoOnBackGuiList(BOOK *, int)
                                      32
     OnBackGuiList(BOOK *, GUI *)     48
     OnSelect1GuiList(BOOK *, GUI *)
                                     124
     OnDeleteGuiList(BOOK *, GUI *)  144
     CreateGuiList(MyBOOK *)         340
     CreateEditGui(MyBOOK *)          24
     MainPageOnEnter(void *, BOOK *)
                                      32
     MainPageOnExit(void *, BOOK *)  132
     bk_msglst_main                   24
     ?<Constant "ExtEditor">          36
     bk_selbcfg                       12
     onMyBookClose(BOOK *)            16
     isExtEditorBook(BOOK *)          28
     main(wchar_t *, wchar_t *, wchar_t *)
                                     132
     ??DataTable1                      4
     ??DataTable3                      4
     ??DataTable6                      4
     ??DataTable7                      4
     ??DataTable10                     4
     ??DataTable11                     4
     ??DataTable14                     4
     ??DataTable15                     4
     ?<Constant L"\x2a\x2e\x70\x6e\x67\x3b\x2a\x2e\
                                     124
     ?<Constant L"\x62\x69\x67\x20\x69\x6d\x67">
                                      64
     ?<Constant L"\x45\x64\x69\x74\x20\x65\x78\x74\
                                      52
     ?<Constant L"\x61\x64\x64\x20\x6e\x65\x77\x20\
                                      24
     ?<Constant L"\x44\x6f\x20\x79\x6f\x75\x20\x77\
                                      60
     ?<Constant "ExtEditor_Base_Page">
                                      20
     ?<Constant "ExtEditor_SelectFile_...">
                                      28
     ?<Constant "ExtEditor_Main_Page">
                                      20
     ?<Constant L"\xa\x45\x78\x74\x45\x64\x69\x74\x
                                      76
     ?<Constant L"\x2f\x45\x78\x74\x65\x6e\x73\x69\_1
                                      40
     ?<Constant "\r\n">                3
     ?<Constant L"\x45\x78\x74\x45\x64\x69\x74\x6f\
                                      20
     ?<Constant L"\x49\x6e\x70\x75\x74\x20\x6e\x65\
                                      28
     ?<Constant "[EXT99]: %s, %s, %s, %s">
                                      24
     ?<Constant L"\x44\x6f\x20\x79\x6f\x75\x20\x77\_1
                                      60
     ?<Constant "">                    1
     ?<Constant L"">                   2
      Others                         228

 
 6 360 bytes in segment CODE
   694 bytes in segment DATA_C
   256 bytes in segment DATA_Z
    88 bytes in segment DYN_PAGE
    12 bytes in segment INITTAB
 
 6 144 bytes of CODE  memory (+ 228 bytes shared)
   782 bytes of CONST memory
   256 bytes of DATA  memory

Errors: none
Warnings: none
